[2024-06-22 15:00:31,335: INFO: main: Starting Custom logging...]
[2024-06-22 15:43:38,234: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:43:38,237: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:51:03,414: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:51:03,418: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:51:03,423: INFO: common: created directory at: artifacts]
[2024-06-22 15:51:03,433: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:51:07,250: INFO: 2391244112:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.zip]
[2024-06-22 15:51:43,659: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:51:43,664: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:51:43,668: INFO: common: created directory at: artifacts]
[2024-06-22 15:51:43,671: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:51:43,676: INFO: 2391244112: File already exists of size: ~ 74490 KB]
[2024-06-22 15:51:50,647: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:51:50,652: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:51:50,655: INFO: common: created directory at: artifacts]
[2024-06-22 15:51:50,659: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:51:50,663: INFO: 2391244112: File already exists of size: ~ 74490 KB]
[2024-06-22 15:52:10,582: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:52:10,587: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:52:10,596: INFO: common: created directory at: artifacts]
[2024-06-22 15:52:10,609: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:52:14,945: INFO: 2391244112:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.zip]
[2024-06-22 15:54:15,295: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:54:15,302: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:54:15,318: INFO: common: created directory at: artifacts]
[2024-06-22 15:54:15,325: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:54:15,336: INFO: 2494678114: File already exists of size: ~ 74490 KB]
[2024-06-22 15:54:25,557: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:54:25,564: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:54:25,580: INFO: common: created directory at: artifacts]
[2024-06-22 15:54:25,606: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:54:30,180: INFO: 2494678114:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.zip]
[2024-06-22 15:54:47,959: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:54:47,963: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:54:47,966: INFO: common: created directory at: artifacts]
[2024-06-22 15:54:47,971: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:54:47,974: INFO: 2494678114: File already exists of size: ~ 74490 KB]
[2024-06-22 15:55:32,663: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:55:32,669: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:55:32,681: INFO: common: created directory at: artifacts]
[2024-06-22 15:55:32,689: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:55:32,694: INFO: 2494678114: File already exists of size: ~ 4 KB]
[2024-06-22 15:56:25,554: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 15:56:25,558: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 15:56:25,561: INFO: common: created directory at: artifacts]
[2024-06-22 15:56:25,563: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 15:56:28,634: INFO: 2494678114:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 16:13:57,884: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:13:57,886: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:13:57,888: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:13:57,889: INFO: common: created directory at: artifacts]
[2024-06-22 16:13:57,890: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:13:57,892: ERROR: stage_01_data_ingestion: name 'url' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 25, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 16, in main
    data_ingestion.download_file()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/data_ingestion.py", line 19, in download_file
    file_id = url.split("/")[-2]
NameError: name 'url' is not defined
[2024-06-22 16:15:35,743: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:15:35,745: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:15:35,747: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:15:35,748: INFO: common: created directory at: artifacts]
[2024-06-22 16:15:35,749: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:15:35,750: ERROR: stage_01_data_ingestion: name 'gdown' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 25, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 16, in main
    data_ingestion.download_file()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/data_ingestion.py", line 21, in download_file
    gdown.download(prefix+file_id, self.config.local_data_file)
NameError: name 'gdown' is not defined
[2024-06-22 16:15:47,108: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:15:47,111: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:15:47,113: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:15:47,114: INFO: common: created directory at: artifacts]
[2024-06-22 16:15:47,115: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:15:47,117: ERROR: stage_01_data_ingestion: name 'gdown' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 25, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 16, in main
    data_ingestion.download_file()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/data_ingestion.py", line 21, in download_file
    gdown.download(prefix+file_id, self.config.local_data_file)
NameError: name 'gdown' is not defined
[2024-06-22 16:16:00,694: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:16:00,697: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:16:00,698: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:16:00,699: INFO: common: created directory at: artifacts]
[2024-06-22 16:16:00,700: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:16:04,819: INFO: data_ingestion:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 16:16:04,834: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 16:16:04,835: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 16:19:45,704: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:19:45,707: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:19:45,711: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:19:45,713: INFO: common: created directory at: artifacts]
[2024-06-22 16:19:45,714: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:19:50,031: INFO: data_ingestion:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 16:19:50,047: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 16:19:50,048: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 16:22:39,245: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 16:22:39,249: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 16:22:39,252: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 16:22:39,255: INFO: common: created directory at: artifacts]
[2024-06-22 16:22:39,256: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 16:22:42,463: INFO: data_ingestion:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 16:22:42,485: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 16:22:42,486: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 17:05:08,713: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 17:05:08,713: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 17:05:08,717: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 17:05:08,720: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 17:05:08,721: INFO: common: created directory at: artifacts]
[2024-06-22 17:05:08,725: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 17:05:08,725: ERROR: stage_02_prepare_base_model: "'ConfigBox' object has no attribute 'base_model_path'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'base_model_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'base_model_path'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'base_model_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'base_model_path'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'base_model_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'base_model_path'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'base_model_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 25, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 14, in main
    prepare_base_model_config = config.get_prepare_base_model_config()
  File "/home/nair.ro/ChickenDiseasaeClassification/src/cnnClassifier/config/configuration.py", line 50, in get_prepare_base_model_config
    base_model_path=Path(config.base_model_path),
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'base_model_path'"
[2024-06-22 17:09:55,499: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 17:09:55,499: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 17:09:55,502: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 17:09:55,506: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 17:09:55,507: INFO: common: created directory at: artifacts]
[2024-06-22 17:09:55,508: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 17:09:55,508: ERROR: stage_02_prepare_base_model: name 'XGBClassifier' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 26, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 17, in main
    xgb = prepare_base_model.prepare_XGBClassifier_model()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/prepare_base_model.py", line 12, in prepare_XGBClassifier_model
    xgb = XGBClassifier(n_estimators=self.config.params_n_estimators ,
NameError: name 'XGBClassifier' is not defined
[2024-06-22 17:10:44,752: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 17:10:44,753: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 17:10:44,755: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 17:10:44,757: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 17:10:44,758: INFO: common: created directory at: artifacts]
[2024-06-22 17:10:44,759: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 17:10:44,760: ERROR: stage_02_prepare_base_model: name 'logger' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 26, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_02_prepare_base_model.py", line 17, in main
    xgb = prepare_base_model.prepare_XGBClassifier_model()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/prepare_base_model.py", line 16, in prepare_XGBClassifier_model
    logger.info(f"Initialized XGBClassifier with following parameters {self.config}")
NameError: name 'logger' is not defined
[2024-06-22 17:11:02,418: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 17:11:02,419: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 17:11:02,421: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 17:11:02,423: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 17:11:02,424: INFO: common: created directory at: artifacts]
[2024-06-22 17:11:02,425: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 17:11:02,426: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 17:11:02,426: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 17:12:39,495: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 17:12:39,495: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 17:12:39,498: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 17:12:39,500: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 17:12:39,500: INFO: common: created directory at: artifacts]
[2024-06-22 17:12:39,501: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 17:12:39,502: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 17:12:39,503: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:10:04,182: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:10:04,182: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:10:04,184: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:10:04,186: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:10:04,187: INFO: common: created directory at: artifacts]
[2024-06-22 18:10:04,188: ERROR: stage_03_training_cross_val: "'ConfigBox' object has no attribute 'local_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 60, in get_training_config
    training_data = self.config.local_data_file
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"
[2024-06-22 18:10:09,490: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:10:09,490: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:10:09,492: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:10:09,494: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:10:09,495: INFO: common: created directory at: artifacts]
[2024-06-22 18:10:09,496: ERROR: stage_03_training_cross_val: "'ConfigBox' object has no attribute 'local_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 60, in get_training_config
    training_data = self.config.local_data_file
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"
[2024-06-22 18:16:28,160: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:16:28,160: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:16:28,169: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:16:28,172: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:16:28,173: INFO: common: created directory at: artifacts]
[2024-06-22 18:16:28,173: ERROR: stage_03_training_cross_val: "'ConfigBox' object has no attribute 'local_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 60, in get_training_config
    training_data = self.config.local_data_file
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"
[2024-06-22 18:18:59,007: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:18:59,010: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:18:59,012: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:18:59,014: INFO: common: created directory at: artifacts]
[2024-06-22 18:18:59,015: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:19:04,608: INFO: data_ingestion:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 18:19:04,624: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:19:04,624: INFO: stage_01_data_ingestion: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:19:15,699: INFO: stage_02_prepare_base_model: *******************]
[2024-06-22 18:19:15,700: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:19:15,702: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:19:15,707: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:19:15,709: INFO: common: created directory at: artifacts]
[2024-06-22 18:19:15,710: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:19:15,710: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:19:15,710: INFO: stage_02_prepare_base_model: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:19:23,864: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:19:23,865: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:19:23,867: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:19:23,873: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:19:23,875: INFO: common: created directory at: artifacts]
[2024-06-22 18:19:23,876: ERROR: stage_03_training_cross_val: "'ConfigBox' object has no attribute 'local_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 60, in get_training_config
    training_data = self.config.local_data_file
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"
[2024-06-22 18:20:21,914: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:20:21,914: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:20:21,917: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:20:21,920: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:20:21,921: INFO: common: created directory at: artifacts]
[2024-06-22 18:20:21,921: ERROR: stage_03_training_cross_val: "'ConfigBox' object has no attribute 'local_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'local_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'local_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 60, in get_training_config
    training_data = self.config.local_data_file
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'local_data_file'"
[2024-06-22 18:22:52,234: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:22:52,235: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:22:52,238: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:22:52,242: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:22:52,243: INFO: common: created directory at: artifacts]
[2024-06-22 18:22:52,246: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:22:52,247: ERROR: stage_03_training_cross_val: TrainingConfig.__init__() got an unexpected keyword argument 'params_scoring']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 65, in get_training_config
    training_config = TrainingConfig(
TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'params_scoring'
[2024-06-22 18:22:57,488: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:22:57,489: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:22:57,491: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:22:57,493: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:22:57,493: INFO: common: created directory at: artifacts]
[2024-06-22 18:22:57,496: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:22:57,496: ERROR: stage_03_training_cross_val: TrainingConfig.__init__() got an unexpected keyword argument 'params_scoring']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 65, in get_training_config
    training_config = TrainingConfig(
TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'params_scoring'
[2024-06-22 18:23:50,914: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:23:50,915: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:23:50,921: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:23:50,926: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:23:50,927: INFO: common: created directory at: artifacts]
[2024-06-22 18:23:50,929: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:23:50,929: ERROR: stage_03_training_cross_val: TrainingConfig.__init__() got an unexpected keyword argument 'params_cv']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 65, in get_training_config
    training_config = TrainingConfig(
TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'params_cv'
[2024-06-22 18:26:05,550: INFO: stage_03_training_cross_val: *******************]
[2024-06-22 18:26:05,551: INFO: stage_03_training_cross_val: >>>>>> stage Training started <<<<<<]
[2024-06-22 18:26:05,557: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:26:05,561: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:26:05,562: INFO: common: created directory at: artifacts]
[2024-06-22 18:26:05,564: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:26:05,565: ERROR: stage_03_training_cross_val: name 'xgb' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 30, in <module>
    obj.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
NameError: name 'xgb' is not defined
[2024-06-22 18:27:29,952: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:27:29,957: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:27:29,966: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:27:29,967: INFO: common: created directory at: artifacts]
[2024-06-22 18:27:29,972: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:27:29,974: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:27:29,979: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:27:29,979: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:27:29,980: INFO: main: *******************]
[2024-06-22 18:27:29,980: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:27:29,981: ERROR: main: name 'PrepareBaseModelTrainingPipeline' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 23, in <module>
    prepare_base_model = PrepareBaseModelTrainingPipeline()
NameError: name 'PrepareBaseModelTrainingPipeline' is not defined
[2024-06-22 18:27:40,726: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:27:40,732: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:27:40,736: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:27:40,740: INFO: common: created directory at: artifacts]
[2024-06-22 18:27:40,742: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:27:40,743: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:27:40,747: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:27:40,747: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:27:40,748: INFO: main: *******************]
[2024-06-22 18:27:40,748: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:27:40,748: ERROR: main: name 'PrepareBaseModelTrainingPipeline' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 23, in <module>
    prepare_base_model = PrepareBaseModelTrainingPipeline()
NameError: name 'PrepareBaseModelTrainingPipeline' is not defined
[2024-06-22 18:29:05,397: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:29:05,405: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:29:05,415: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:29:05,417: INFO: common: created directory at: artifacts]
[2024-06-22 18:29:05,422: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:29:05,425: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:29:05,430: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:29:05,433: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:29:05,434: INFO: main: *******************]
[2024-06-22 18:29:05,434: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:29:05,440: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:29:05,444: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:29:05,445: INFO: common: created directory at: artifacts]
[2024-06-22 18:29:05,447: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:29:05,448: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:29:05,448: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:29:05,449: INFO: main: *******************]
[2024-06-22 18:29:05,449: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:29:05,452: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:29:05,457: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:29:05,459: INFO: common: created directory at: artifacts]
[2024-06-22 18:29:05,460: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:29:05,461: ERROR: main: name 'train_valid_generator' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 37, in train
    X_train , X_test ,y_train , y_test  = train_valid_generator()
NameError: name 'train_valid_generator' is not defined
[2024-06-22 18:30:40,463: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:30:40,471: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:30:40,477: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:30:40,480: INFO: common: created directory at: artifacts]
[2024-06-22 18:30:40,482: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:30:40,485: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:30:40,489: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:30:40,489: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:30:40,490: INFO: main: *******************]
[2024-06-22 18:30:40,490: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:30:40,493: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:30:40,496: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:30:40,497: INFO: common: created directory at: artifacts]
[2024-06-22 18:30:40,499: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:30:40,500: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:30:40,500: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:30:40,500: INFO: main: *******************]
[2024-06-22 18:30:40,500: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:30:40,503: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:30:40,507: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:30:40,510: INFO: common: created directory at: artifacts]
[2024-06-22 18:30:40,512: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:30:40,513: ERROR: main: name 'pd' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 37, in train
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 12, in train_valid_generator
    df = pd.read_csv(self.config.training_data,encoding='utf-8')
NameError: name 'pd' is not defined
[2024-06-22 18:31:05,232: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:31:05,237: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:05,241: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:05,242: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:05,243: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:31:05,244: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:31:05,245: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:31:05,246: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:31:05,246: INFO: main: *******************]
[2024-06-22 18:31:05,246: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:31:05,250: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:05,252: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:05,254: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:05,255: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:31:05,255: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:31:05,256: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:31:05,256: INFO: main: *******************]
[2024-06-22 18:31:05,256: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:31:05,259: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:05,263: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:05,263: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:05,264: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:31:06,260: ERROR: main: name 'train_test_split' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 37, in train
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 18, in train_valid_generator
    X_train , X_test ,y_train , y_test = train_test_split(X,y,test_size = 0.2 ,random_state = 42 ,stratify=y)
NameError: name 'train_test_split' is not defined
[2024-06-22 18:31:39,666: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:31:39,669: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:39,670: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:39,672: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:39,673: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:31:39,673: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:31:39,675: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:31:39,675: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:31:39,675: INFO: main: *******************]
[2024-06-22 18:31:39,676: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:31:39,679: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:39,681: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:39,682: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:39,687: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:31:39,687: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:31:39,687: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:31:39,688: INFO: main: *******************]
[2024-06-22 18:31:39,688: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:31:39,691: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:31:39,693: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:31:39,694: INFO: common: created directory at: artifacts]
[2024-06-22 18:31:39,695: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:31:41,008: ERROR: main: name 'logger' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 40, in train
    logger.info(f"Model training and cross validation initiated.")
NameError: name 'logger' is not defined
[2024-06-22 18:32:37,411: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:32:37,414: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:32:37,416: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:32:37,417: INFO: common: created directory at: artifacts]
[2024-06-22 18:32:37,418: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:32:37,419: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:32:37,420: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:32:37,420: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:32:37,420: INFO: main: *******************]
[2024-06-22 18:32:37,420: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:32:37,422: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:32:37,424: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:32:37,425: INFO: common: created directory at: artifacts]
[2024-06-22 18:32:37,426: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:32:37,426: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:32:37,426: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:32:37,426: INFO: main: *******************]
[2024-06-22 18:32:37,426: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:32:37,429: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:32:37,430: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:32:37,431: INFO: common: created directory at: artifacts]
[2024-06-22 18:32:37,432: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:32:38,680: INFO: training: Model training and cross validation initiated.]
[2024-06-22 18:32:38,680: ERROR: main: name 'validate' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    model = validate( xgb  ,X_train,y_train, self.config.params_scoring ,self.config.params_cv)
NameError: name 'validate' is not defined
[2024-06-22 18:33:16,252: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:33:16,255: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:33:16,261: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:33:16,262: INFO: common: created directory at: artifacts]
[2024-06-22 18:33:16,263: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:33:16,263: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:33:16,265: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:33:16,265: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:33:16,265: INFO: main: *******************]
[2024-06-22 18:33:16,266: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:33:16,268: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:33:16,271: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:33:16,272: INFO: common: created directory at: artifacts]
[2024-06-22 18:33:16,272: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:33:16,272: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:33:16,273: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:33:16,273: INFO: main: *******************]
[2024-06-22 18:33:16,273: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:33:16,276: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:33:16,278: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:33:16,279: INFO: common: created directory at: artifacts]
[2024-06-22 18:33:16,280: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:33:17,659: INFO: training: Model training and cross validation initiated.]
[2024-06-22 18:33:17,660: ERROR: main: 'TrainingConfig' object has no attribute 'params_scoring']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    model = self.validate( xgb  ,X_train,y_train, self.config.params_scoring ,self.config.params_cv)
AttributeError: 'TrainingConfig' object has no attribute 'params_scoring'
[2024-06-22 18:34:38,721: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:34:38,724: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:34:38,726: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:34:38,727: INFO: common: created directory at: artifacts]
[2024-06-22 18:34:38,728: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:34:38,729: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:34:38,730: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:34:38,730: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:34:38,730: INFO: main: *******************]
[2024-06-22 18:34:38,730: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:34:38,734: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:34:38,736: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:34:38,736: INFO: common: created directory at: artifacts]
[2024-06-22 18:34:38,737: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:34:38,737: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:34:38,738: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:34:38,738: INFO: main: *******************]
[2024-06-22 18:34:38,738: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:34:38,740: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:34:38,743: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:34:38,743: INFO: common: created directory at: artifacts]
[2024-06-22 18:34:38,744: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:34:40,293: INFO: training: Model training and cross validation initiated.]
[2024-06-22 18:34:40,293: ERROR: main: Training.validate() takes 5 positional arguments but 6 were given]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    model = self.validate( xgb  ,X_train,y_train, self.config.scoring ,self.config.cv)
TypeError: Training.validate() takes 5 positional arguments but 6 were given
[2024-06-22 18:36:34,207: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 18:36:34,210: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:36:34,213: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:36:34,214: INFO: common: created directory at: artifacts]
[2024-06-22 18:36:34,215: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 18:36:34,219: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 18:36:34,220: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 18:36:34,221: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 18:36:34,221: INFO: main: *******************]
[2024-06-22 18:36:34,221: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 18:36:34,223: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:36:34,225: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:36:34,226: INFO: common: created directory at: artifacts]
[2024-06-22 18:36:34,231: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 18:36:34,231: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 18:36:34,232: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 18:36:34,232: INFO: main: *******************]
[2024-06-22 18:36:34,232: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 18:36:34,235: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 18:36:34,240: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 18:36:34,242: INFO: common: created directory at: artifacts]
[2024-06-22 18:36:34,242: INFO: common: created directory at: artifacts/training]
[2024-06-22 18:36:35,618: INFO: training: Model training and cross validation initiated.]
[2024-06-22 18:38:21,264: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 18:38:21,265: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 18:38:21,265: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 18:38:44,916: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 18:38:44,917: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 19:03:51,361: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:03:51,365: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:03:51,369: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:03:51,373: INFO: common: created directory at: artifacts]
[2024-06-22 19:03:51,377: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:03:55,699: INFO: data_ingestion:  file from url https://drive.google.com/uc?/export=download&id=1RmDs2j3QcY05ixoV1-ACmxmnM5xdmiGF downloaded and saved at path artifacts/data_ingestion/card_transdata.csv]
[2024-06-22 19:03:55,713: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:03:55,713: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:03:55,713: INFO: main: *******************]
[2024-06-22 19:03:55,714: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:03:55,717: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:03:55,719: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:03:55,720: INFO: common: created directory at: artifacts]
[2024-06-22 19:03:55,723: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:03:55,724: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:03:55,724: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:03:55,725: INFO: main: *******************]
[2024-06-22 19:03:55,726: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:03:55,728: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:03:55,731: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:03:55,732: INFO: common: created directory at: artifacts]
[2024-06-22 19:03:55,734: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:03:55,735: ERROR: main: TrainingConfig.__init__() missing 2 required positional arguments: 'stratify' and 'test_size']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 63, in get_training_config
    training_config = TrainingConfig(
TypeError: TrainingConfig.__init__() missing 2 required positional arguments: 'stratify' and 'test_size'
[2024-06-22 19:04:55,013: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:04:55,016: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:04:55,018: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:04:55,020: INFO: common: created directory at: artifacts]
[2024-06-22 19:04:55,022: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:04:55,023: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:04:55,025: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:04:55,025: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:04:55,025: INFO: main: *******************]
[2024-06-22 19:04:55,026: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:04:55,028: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:04:55,031: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:04:55,032: INFO: common: created directory at: artifacts]
[2024-06-22 19:04:55,033: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:04:55,033: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:04:55,033: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:04:55,033: INFO: main: *******************]
[2024-06-22 19:04:55,034: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:04:55,036: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:04:55,041: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:04:55,041: INFO: common: created directory at: artifacts]
[2024-06-22 19:04:55,042: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:04:55,983: ERROR: main: 'TrainingConfig' object has no attribute 'random_state']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 40, in train
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 21, in train_valid_generator
    X_train , X_test ,y_train , y_test = train_test_split(X,y,test_size = self.config.test_size ,random_state =self.config.random_state  ,stratify=self.config.stratify)
AttributeError: 'TrainingConfig' object has no attribute 'random_state'
[2024-06-22 19:05:46,012: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:05:46,015: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:05:46,017: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:05:46,019: INFO: common: created directory at: artifacts]
[2024-06-22 19:05:46,020: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:05:46,022: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:05:46,024: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:05:46,024: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:05:46,025: INFO: main: *******************]
[2024-06-22 19:05:46,025: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:05:46,027: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:05:46,030: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:05:46,030: INFO: common: created directory at: artifacts]
[2024-06-22 19:05:46,031: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:05:46,031: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:05:46,032: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:05:46,032: INFO: main: *******************]
[2024-06-22 19:05:46,032: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:05:46,036: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:05:46,037: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:05:46,038: INFO: common: created directory at: artifacts]
[2024-06-22 19:05:46,039: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:05:46,039: ERROR: main: TrainingConfig.__init__() got an unexpected keyword argument 'random_state']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 16, in main
    training_config = config.get_training_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 63, in get_training_config
    training_config = TrainingConfig(
TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'random_state'
[2024-06-22 19:08:44,289: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:08:44,291: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:08:44,293: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:08:44,295: INFO: common: created directory at: artifacts]
[2024-06-22 19:08:44,296: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:08:44,297: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:08:44,298: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:08:44,298: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:08:44,299: INFO: main: *******************]
[2024-06-22 19:08:44,299: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:08:44,301: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:08:44,303: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:08:44,304: INFO: common: created directory at: artifacts]
[2024-06-22 19:08:44,305: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:08:44,305: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:08:44,305: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:08:44,305: INFO: main: *******************]
[2024-06-22 19:08:44,305: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:08:44,308: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:08:44,310: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:08:44,311: INFO: common: created directory at: artifacts]
[2024-06-22 19:08:44,312: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:08:45,192: ERROR: main: The 'stratify' parameter of train_test_split must be an array-like or None. Got 'y' instead.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 19, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 40, in train
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 21, in train_valid_generator
    X_train , X_test ,y_train , y_test = train_test_split(X,y,test_size = self.config.test_size ,random_state =self.config.random_state  ,stratify=self.config.stratify)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 203, in wrapper
    validate_parameter_constraints(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'stratify' parameter of train_test_split must be an array-like or None. Got 'y' instead.
[2024-06-22 19:11:26,363: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:11:26,365: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:11:26,368: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:11:26,369: INFO: common: created directory at: artifacts]
[2024-06-22 19:11:26,369: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:11:26,370: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:11:26,372: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:11:26,372: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:11:26,372: INFO: main: *******************]
[2024-06-22 19:11:26,372: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:11:26,376: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:11:26,377: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:11:26,380: INFO: common: created directory at: artifacts]
[2024-06-22 19:11:26,381: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:11:26,381: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:11:26,381: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:11:26,382: INFO: main: *******************]
[2024-06-22 19:11:26,382: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:11:26,384: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:11:26,387: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:11:26,387: INFO: common: created directory at: artifacts]
[2024-06-22 19:11:26,388: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:11:27,649: INFO: training: Model training and cross validation initiated.]
[2024-06-22 19:13:17,737: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 19:13:17,738: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 19:13:17,739: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 19:13:47,031: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 19:13:47,032: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 19:43:11,275: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:43:11,279: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:43:11,283: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:43:11,283: INFO: common: created directory at: artifacts]
[2024-06-22 19:43:11,284: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:43:11,285: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:43:11,286: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:43:11,286: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:43:11,286: INFO: main: *******************]
[2024-06-22 19:43:11,287: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:43:11,290: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:43:11,292: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:43:11,292: INFO: common: created directory at: artifacts]
[2024-06-22 19:43:11,293: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:43:11,293: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:43:11,293: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:43:11,294: INFO: main: *******************]
[2024-06-22 19:43:11,294: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:43:11,297: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:43:11,299: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:43:11,300: INFO: common: created directory at: artifacts]
[2024-06-22 19:43:11,301: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:43:12,694: INFO: training: Model training and cross validation initiated.]
[2024-06-22 19:44:57,939: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 19:44:57,940: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 19:44:57,940: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 19:45:21,836: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 19:45:21,837: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 19:45:21,837: INFO: main: *******************]
[2024-06-22 19:45:21,837: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 19:45:21,837: ERROR: main: name 'EvaluationPipeline' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 51, in <module>
    model_evalution = EvaluationPipeline()
NameError: name 'EvaluationPipeline' is not defined
[2024-06-22 19:52:25,482: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:52:25,489: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:52:25,493: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:52:25,494: INFO: common: created directory at: artifacts]
[2024-06-22 19:52:25,495: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:52:25,497: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:52:25,500: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:52:25,500: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:52:25,501: INFO: main: *******************]
[2024-06-22 19:52:25,502: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:52:25,506: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:52:25,509: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:52:25,511: INFO: common: created directory at: artifacts]
[2024-06-22 19:52:25,513: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:52:25,513: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:52:25,513: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:52:25,514: INFO: main: *******************]
[2024-06-22 19:52:25,514: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:52:25,519: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:52:25,522: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:52:25,523: INFO: common: created directory at: artifacts]
[2024-06-22 19:52:25,527: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:52:27,250: INFO: training: Model training and cross validation initiated.]
[2024-06-22 19:54:13,200: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 19:54:13,203: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 19:54:13,203: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 19:54:37,229: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 19:54:37,232: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 19:54:37,232: INFO: main: *******************]
[2024-06-22 19:54:37,232: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 19:54:37,232: ERROR: main: name 'model_evaluation' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 15, in main
    model_evaluation(xgb)
NameError: name 'model_evaluation' is not defined
[2024-06-22 19:57:30,148: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 19:57:30,152: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:57:30,156: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:57:30,157: INFO: common: created directory at: artifacts]
[2024-06-22 19:57:30,159: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 19:57:30,160: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 19:57:30,161: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 19:57:30,161: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 19:57:30,162: INFO: main: *******************]
[2024-06-22 19:57:30,162: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 19:57:30,165: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:57:30,167: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:57:30,173: INFO: common: created directory at: artifacts]
[2024-06-22 19:57:30,173: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 19:57:30,174: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 19:57:30,174: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 19:57:30,174: INFO: main: *******************]
[2024-06-22 19:57:30,175: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 19:57:30,177: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 19:57:30,180: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 19:57:30,181: INFO: common: created directory at: artifacts]
[2024-06-22 19:57:30,181: INFO: common: created directory at: artifacts/training]
[2024-06-22 19:57:31,449: INFO: training: Model training and cross validation initiated.]
[2024-06-22 19:59:17,079: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 19:59:17,080: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 19:59:17,081: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 19:59:41,565: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 19:59:41,566: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 19:59:41,566: INFO: main: *******************]
[2024-06-22 19:59:41,566: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 19:59:41,567: ERROR: main: name 'model_evaluation' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 17, in main
    model_evaluation(xgb)
NameError: name 'model_evaluation' is not defined
[2024-06-22 20:00:43,869: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:00:43,872: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:00:43,876: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:00:43,877: INFO: common: created directory at: artifacts]
[2024-06-22 20:00:43,882: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:00:43,883: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:00:43,885: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:00:43,885: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:00:43,886: INFO: main: *******************]
[2024-06-22 20:00:43,886: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:00:43,890: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:00:43,892: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:00:43,893: INFO: common: created directory at: artifacts]
[2024-06-22 20:00:43,894: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:00:43,895: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:00:43,895: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:00:43,895: INFO: main: *******************]
[2024-06-22 20:00:43,895: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:00:43,898: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:00:43,901: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:00:43,903: INFO: common: created directory at: artifacts]
[2024-06-22 20:00:43,904: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:00:45,181: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:02:59,773: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:02:59,773: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:02:59,775: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:03:24,197: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:03:24,198: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:03:24,202: INFO: main: *******************]
[2024-06-22 20:03:24,205: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:03:24,207: ERROR: main: Evaluation.__init__() missing 1 required positional argument: 'config']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 16, in main
    evalu = Evaluation()
TypeError: Evaluation.__init__() missing 1 required positional argument: 'config'
[2024-06-22 20:03:58,453: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:03:58,457: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:03:58,460: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:03:58,461: INFO: common: created directory at: artifacts]
[2024-06-22 20:03:58,463: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:03:58,464: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:03:58,467: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:03:58,467: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:03:58,469: INFO: main: *******************]
[2024-06-22 20:03:58,470: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:03:58,475: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:03:58,478: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:03:58,479: INFO: common: created directory at: artifacts]
[2024-06-22 20:03:58,481: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:03:58,482: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:03:58,484: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:03:58,485: INFO: main: *******************]
[2024-06-22 20:03:58,487: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:03:58,493: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:03:58,496: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:03:58,498: INFO: common: created directory at: artifacts]
[2024-06-22 20:03:58,498: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:03:59,988: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:05:45,885: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:05:45,886: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:05:45,888: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:06:10,071: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:06:10,072: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:06:10,074: INFO: main: *******************]
[2024-06-22 20:06:10,075: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:06:10,077: ERROR: main: Evaluation.__init__() missing 1 required positional argument: 'config']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 16, in main
    evalu = Evaluation()
TypeError: Evaluation.__init__() missing 1 required positional argument: 'config'
[2024-06-22 20:09:42,278: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:09:42,282: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:09:42,284: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:09:42,285: INFO: common: created directory at: artifacts]
[2024-06-22 20:09:42,287: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:09:42,288: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:09:42,295: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:09:42,295: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:09:42,297: INFO: main: *******************]
[2024-06-22 20:09:42,300: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:09:42,308: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:09:42,311: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:09:42,312: INFO: common: created directory at: artifacts]
[2024-06-22 20:09:42,313: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:09:42,314: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:09:42,316: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:09:42,317: INFO: main: *******************]
[2024-06-22 20:09:42,321: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:09:42,326: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:09:42,329: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:09:42,330: INFO: common: created directory at: artifacts]
[2024-06-22 20:09:42,331: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:09:43,788: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:11:30,430: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:11:30,431: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:11:30,433: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:11:54,196: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:11:54,197: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:11:54,200: INFO: main: *******************]
[2024-06-22 20:11:54,202: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:11:54,207: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:11:54,210: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:11:54,210: INFO: common: created directory at: artifacts]
[2024-06-22 20:11:54,212: ERROR: main: Evaluation.model_evaluation() missing 2 required positional arguments: 'X_test' and 'y_test']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
TypeError: Evaluation.model_evaluation() missing 2 required positional arguments: 'X_test' and 'y_test'
[2024-06-22 20:13:02,666: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:13:02,670: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:13:02,674: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:13:02,674: INFO: common: created directory at: artifacts]
[2024-06-22 20:13:02,676: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:13:02,678: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:13:02,682: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:13:02,682: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:13:02,684: INFO: main: *******************]
[2024-06-22 20:13:02,686: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:13:02,689: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:13:02,691: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:13:02,692: INFO: common: created directory at: artifacts]
[2024-06-22 20:13:02,693: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:13:02,694: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:13:02,696: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:13:02,697: INFO: main: *******************]
[2024-06-22 20:13:02,698: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:13:02,702: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:13:02,705: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:13:02,706: INFO: common: created directory at: artifacts]
[2024-06-22 20:13:02,707: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:13:04,486: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:14:49,426: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:14:49,427: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:14:49,429: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:15:13,267: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:15:13,268: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:15:13,270: INFO: main: *******************]
[2024-06-22 20:15:13,271: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:15:13,277: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:15:13,279: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:15:13,281: INFO: common: created directory at: artifacts]
[2024-06-22 20:15:13,282: ERROR: main: name 'X_test' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 53, in model_evaluation
    y_proba_test = model.predict_proba(X_test)
NameError: name 'X_test' is not defined
[2024-06-22 20:15:19,009: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:15:19,012: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:15:19,016: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:15:19,017: INFO: common: created directory at: artifacts]
[2024-06-22 20:15:19,018: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:15:19,020: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:15:19,022: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:15:19,022: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:15:19,024: INFO: main: *******************]
[2024-06-22 20:15:19,025: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:15:19,032: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:15:19,034: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:15:19,035: INFO: common: created directory at: artifacts]
[2024-06-22 20:15:19,036: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:15:19,037: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:15:19,038: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:15:19,039: INFO: main: *******************]
[2024-06-22 20:15:19,040: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:15:19,045: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:15:19,047: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:15:19,050: INFO: common: created directory at: artifacts]
[2024-06-22 20:15:19,067: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:16:07,026: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:16:07,029: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:16:07,031: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:16:07,032: INFO: common: created directory at: artifacts]
[2024-06-22 20:16:07,034: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:16:07,035: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:16:07,038: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:16:07,039: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:16:07,040: INFO: main: *******************]
[2024-06-22 20:16:07,042: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:16:07,045: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:16:07,048: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:16:07,049: INFO: common: created directory at: artifacts]
[2024-06-22 20:16:07,051: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:16:07,053: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:16:07,054: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:16:07,056: INFO: main: *******************]
[2024-06-22 20:16:07,057: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:16:07,061: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:16:07,063: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:16:07,073: INFO: common: created directory at: artifacts]
[2024-06-22 20:16:07,075: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:16:08,358: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:17:54,174: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:17:54,175: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:17:54,175: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:18:17,812: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:18:17,813: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:18:17,814: INFO: main: *******************]
[2024-06-22 20:18:17,815: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:18:17,821: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:18:17,823: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:18:17,824: INFO: common: created directory at: artifacts]
[2024-06-22 20:18:17,827: ERROR: main: name 'pd' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 53, in model_evaluation
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 15, in train_valid_generator
    df = pd.read_csv(self.config.training_data,encoding='utf-8')
NameError: name 'pd' is not defined
[2024-06-22 20:21:44,266: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:21:44,270: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:21:44,274: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:21:44,276: INFO: common: created directory at: artifacts]
[2024-06-22 20:21:44,277: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:21:44,279: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:21:44,281: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:21:44,282: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:21:44,283: INFO: main: *******************]
[2024-06-22 20:21:44,285: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:21:44,289: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:21:44,292: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:21:44,292: INFO: common: created directory at: artifacts]
[2024-06-22 20:21:44,294: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:21:44,295: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:21:44,298: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:21:44,299: INFO: main: *******************]
[2024-06-22 20:21:44,301: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:21:44,305: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:21:44,308: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:21:44,308: INFO: common: created directory at: artifacts]
[2024-06-22 20:21:44,311: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:21:45,541: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:27:47,033: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:27:47,042: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:27:47,056: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:27:47,058: INFO: common: created directory at: artifacts]
[2024-06-22 20:27:47,062: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:27:47,067: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:27:47,086: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:27:47,087: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:27:47,093: INFO: main: *******************]
[2024-06-22 20:27:47,095: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:27:47,106: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:27:47,110: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:27:47,112: INFO: common: created directory at: artifacts]
[2024-06-22 20:27:47,115: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:27:47,117: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:27:47,119: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:27:47,123: INFO: main: *******************]
[2024-06-22 20:27:47,136: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:27:47,145: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:27:47,149: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:27:47,152: INFO: common: created directory at: artifacts]
[2024-06-22 20:27:47,154: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:27:48,790: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:29:41,168: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:29:41,169: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:29:41,171: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:30:08,959: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:30:08,961: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:30:08,963: INFO: main: *******************]
[2024-06-22 20:30:08,965: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:30:08,975: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:30:08,983: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:30:09,019: INFO: common: created directory at: artifacts]
[2024-06-22 20:30:09,028: ERROR: main: 'EvaluationConfig' object has no attribute 'training_data']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 53, in model_evaluation
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 15, in train_valid_generator
    df = pd.read_csv(self.config.training_data,encoding='utf-8')
AttributeError: 'EvaluationConfig' object has no attribute 'training_data'
[2024-06-22 20:31:54,659: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:31:54,663: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:31:54,667: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:31:54,668: INFO: common: created directory at: artifacts]
[2024-06-22 20:31:54,670: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:31:54,671: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:31:54,673: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:31:54,674: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:31:54,676: INFO: main: *******************]
[2024-06-22 20:31:54,677: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:31:54,682: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:31:54,684: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:31:54,685: INFO: common: created directory at: artifacts]
[2024-06-22 20:31:54,686: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:31:54,687: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:31:54,689: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:31:54,692: INFO: main: *******************]
[2024-06-22 20:31:54,693: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:31:54,699: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:31:54,701: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:31:54,702: INFO: common: created directory at: artifacts]
[2024-06-22 20:31:54,703: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:31:56,074: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:34:13,391: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:34:13,392: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:34:13,395: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:34:40,041: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:34:40,042: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:34:40,044: INFO: main: *******************]
[2024-06-22 20:34:40,046: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:34:40,052: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:34:40,054: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:34:40,055: INFO: common: created directory at: artifacts]
[2024-06-22 20:34:40,859: ERROR: main: name 'train_test_split' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 53, in model_evaluation
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 21, in train_valid_generator
    X_train , X_test ,y_train , y_test = train_test_split(X,y,test_size = self.config.test_size ,random_state =self.config.random_state  ,stratify=y)
NameError: name 'train_test_split' is not defined
[2024-06-22 20:35:38,892: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:35:38,897: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:35:38,903: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:35:38,904: INFO: common: created directory at: artifacts]
[2024-06-22 20:35:38,907: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:35:38,909: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:35:38,912: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:35:38,913: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:35:38,916: INFO: main: *******************]
[2024-06-22 20:35:38,918: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:35:38,923: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:35:38,926: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:35:38,928: INFO: common: created directory at: artifacts]
[2024-06-22 20:35:38,930: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:35:38,931: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:35:38,935: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:35:38,936: INFO: main: *******************]
[2024-06-22 20:35:38,938: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:35:38,945: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:35:38,947: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:35:38,950: INFO: common: created directory at: artifacts]
[2024-06-22 20:35:38,951: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:35:40,445: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:37:25,090: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:37:25,091: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:37:25,095: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:37:48,727: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:37:48,728: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:37:48,730: INFO: main: *******************]
[2024-06-22 20:37:48,731: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:37:48,737: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:37:48,739: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:37:48,741: INFO: common: created directory at: artifacts]
[2024-06-22 20:37:49,525: ERROR: main: 'EvaluationConfig' object has no attribute 'test_size']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 55, in model_evaluation
    X_train , X_test ,y_train , y_test  = self.train_valid_generator()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 23, in train_valid_generator
    X_train , X_test ,y_train , y_test = train_test_split(X,y,test_size = self.config.test_size ,random_state =self.config.random_state  ,stratify=y)
AttributeError: 'EvaluationConfig' object has no attribute 'test_size'
[2024-06-22 20:39:12,370: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:39:12,374: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:39:12,378: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:39:12,379: INFO: common: created directory at: artifacts]
[2024-06-22 20:39:12,380: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:39:12,381: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:39:12,385: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:39:12,385: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:39:12,387: INFO: main: *******************]
[2024-06-22 20:39:12,388: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:39:12,393: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:39:12,396: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:39:12,398: INFO: common: created directory at: artifacts]
[2024-06-22 20:39:12,399: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:39:12,400: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:39:12,402: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:39:12,404: INFO: main: *******************]
[2024-06-22 20:39:12,419: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:39:12,423: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:39:12,426: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:39:12,427: INFO: common: created directory at: artifacts]
[2024-06-22 20:39:12,427: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:39:13,894: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:41:02,428: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:41:02,429: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:41:02,433: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:41:30,334: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:41:30,335: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:41:30,336: INFO: main: *******************]
[2024-06-22 20:41:30,338: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:41:30,344: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:41:30,347: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:41:30,348: INFO: common: created directory at: artifacts]
[2024-06-22 20:41:36,498: INFO: evaluation:               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    182519
         1.0       0.99      0.99      0.99     17481

    accuracy                           1.00    200000
   macro avg       0.99      0.99      0.99    200000
weighted avg       1.00      1.00      1.00    200000
]
[2024-06-22 20:41:36,793: ERROR: main: save_figure_with_timestamp() missing 1 required positional argument: 'fig']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 68, in model_evaluation
    save_figure_with_timestamp(prefix="confusion_matrix")
TypeError: save_figure_with_timestamp() missing 1 required positional argument: 'fig'
[2024-06-22 20:45:53,863: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:45:53,867: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:45:53,871: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:45:53,872: INFO: common: created directory at: artifacts]
[2024-06-22 20:45:53,877: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:45:53,880: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:45:53,882: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:45:53,882: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:45:53,884: INFO: main: *******************]
[2024-06-22 20:45:53,885: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:45:53,890: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:45:53,892: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:45:53,893: INFO: common: created directory at: artifacts]
[2024-06-22 20:45:53,895: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:45:53,896: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:45:53,898: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:45:53,900: INFO: main: *******************]
[2024-06-22 20:45:53,902: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:45:53,908: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:45:53,911: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:45:53,912: INFO: common: created directory at: artifacts]
[2024-06-22 20:45:53,913: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:45:55,288: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:47:42,730: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:47:42,730: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:47:42,744: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:48:07,108: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:48:07,110: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:48:07,112: INFO: main: *******************]
[2024-06-22 20:48:07,113: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:48:07,142: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:48:07,146: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:48:07,150: INFO: common: created directory at: artifacts]
[2024-06-22 20:48:07,150: ERROR: main: Evaluation.model_evaluation() missing 1 required positional argument: 'y_test']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
TypeError: Evaluation.model_evaluation() missing 1 required positional argument: 'y_test'
[2024-06-22 20:48:47,530: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:48:47,534: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:48:47,538: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:48:47,539: INFO: common: created directory at: artifacts]
[2024-06-22 20:48:47,540: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:48:47,542: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:48:47,543: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:48:47,544: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:48:47,545: INFO: main: *******************]
[2024-06-22 20:48:47,546: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:48:47,550: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:48:47,554: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:48:47,555: INFO: common: created directory at: artifacts]
[2024-06-22 20:48:47,558: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:48:47,559: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:48:47,563: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:48:47,567: INFO: main: *******************]
[2024-06-22 20:48:47,568: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:48:47,573: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:48:47,575: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:48:47,576: INFO: common: created directory at: artifacts]
[2024-06-22 20:48:47,578: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:48:49,139: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:50:34,570: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:50:34,572: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:50:34,575: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:50:58,283: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:50:58,284: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:50:58,286: INFO: main: *******************]
[2024-06-22 20:50:58,287: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:50:58,293: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:50:58,295: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:50:58,296: INFO: common: created directory at: artifacts]
[2024-06-22 20:50:58,297: ERROR: main: name 'X_test' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 56, in model_evaluation
    y_proba_test = model.predict_proba(X_test)
NameError: name 'X_test' is not defined
[2024-06-22 20:52:43,687: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:52:43,691: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:52:43,694: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:52:43,695: INFO: common: created directory at: artifacts]
[2024-06-22 20:52:43,696: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:52:43,697: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:52:43,699: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:52:43,700: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:52:43,701: INFO: main: *******************]
[2024-06-22 20:52:43,703: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:52:43,707: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:52:43,709: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:52:43,710: INFO: common: created directory at: artifacts]
[2024-06-22 20:52:43,711: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:52:43,712: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:52:43,714: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:52:43,715: INFO: main: *******************]
[2024-06-22 20:52:43,716: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:52:43,720: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:52:43,722: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:52:43,724: INFO: common: created directory at: artifacts]
[2024-06-22 20:52:43,724: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:52:45,063: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:54:30,168: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:54:30,169: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:54:30,173: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:54:53,926: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:54:53,926: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:54:53,928: INFO: main: *******************]
[2024-06-22 20:54:53,930: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:54:53,935: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:54:53,938: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:54:53,939: INFO: common: created directory at: artifacts]
[2024-06-22 20:54:58,388: ERROR: main: name 'px' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 65, in model_evaluation
    fig = px.imshow(cm_df, text_auto=True, color_continuous_scale=color,
NameError: name 'px' is not defined
[2024-06-22 20:55:39,748: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 20:55:39,753: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:55:39,771: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:55:39,772: INFO: common: created directory at: artifacts]
[2024-06-22 20:55:39,774: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 20:55:39,775: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 20:55:39,777: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 20:55:39,778: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 20:55:39,785: INFO: main: *******************]
[2024-06-22 20:55:39,792: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 20:55:39,803: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:55:39,814: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:55:39,831: INFO: common: created directory at: artifacts]
[2024-06-22 20:55:39,843: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 20:55:39,845: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 20:55:39,847: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 20:55:39,849: INFO: main: *******************]
[2024-06-22 20:55:39,850: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 20:55:39,857: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:55:39,874: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:55:39,876: INFO: common: created directory at: artifacts]
[2024-06-22 20:55:39,882: INFO: common: created directory at: artifacts/training]
[2024-06-22 20:55:41,287: INFO: training: Model training and cross validation initiated.]
[2024-06-22 20:57:27,141: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 20:57:27,142: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 20:57:27,146: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 20:57:50,942: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 20:57:50,943: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 20:57:50,948: INFO: main: *******************]
[2024-06-22 20:57:50,950: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 20:57:50,959: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 20:57:50,968: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 20:57:50,975: INFO: common: created directory at: artifacts]
[2024-06-22 20:58:02,171: ERROR: main: 
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido
]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 71, in model_evaluation
    save_figure_with_timestamp(fig, prefix="confusion_matrix")
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/utils/common.py", line 140, in save_figure_with_timestamp
    write_image(fig, filename)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/plotly/io/_kaleido.py", line 266, in write_image
    img_data = to_image(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/plotly/io/_kaleido.py", line 132, in to_image
    raise ValueError(
ValueError: 
Image export using the "kaleido" engine requires the kaleido package,
which can be installed using pip:
    $ pip install -U kaleido

[2024-06-22 21:02:16,873: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:02:16,880: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:02:16,888: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:02:16,890: INFO: common: created directory at: artifacts]
[2024-06-22 21:02:16,899: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:02:16,904: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:02:16,910: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:02:16,911: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:02:16,914: INFO: main: *******************]
[2024-06-22 21:02:16,921: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:02:16,936: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:02:16,949: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:02:16,953: INFO: common: created directory at: artifacts]
[2024-06-22 21:02:16,960: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:02:16,961: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:02:16,963: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:02:16,966: INFO: main: *******************]
[2024-06-22 21:02:16,969: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:02:16,976: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:02:16,986: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:02:16,988: INFO: common: created directory at: artifacts]
[2024-06-22 21:02:16,998: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:02:18,621: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:04:12,661: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:04:12,662: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:04:12,662: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:04:36,685: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:04:36,688: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:04:36,695: INFO: main: *******************]
[2024-06-22 21:04:36,707: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:04:36,715: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:04:36,724: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:04:36,727: INFO: common: created directory at: artifacts]
[2024-06-22 21:04:46,396: INFO: common: Figure saved as: confusion_matrix_20240622_210444.png]
[2024-06-22 21:04:46,403: ERROR: main: Evaluation.precision_recall_trade_off() missing 2 required positional arguments: 'X_test' and 'y_test']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 21, in main
    evalu.precision_recall_trade_off(xgb)
TypeError: Evaluation.precision_recall_trade_off() missing 2 required positional arguments: 'X_test' and 'y_test'
[2024-06-22 21:05:22,507: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:05:22,511: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:05:22,514: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:05:22,515: INFO: common: created directory at: artifacts]
[2024-06-22 21:05:22,520: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:05:22,526: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:05:22,528: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:05:22,528: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:05:22,530: INFO: main: *******************]
[2024-06-22 21:05:22,532: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:05:22,537: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:05:22,541: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:05:22,548: INFO: common: created directory at: artifacts]
[2024-06-22 21:05:22,554: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:05:22,555: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:05:22,556: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:05:22,558: INFO: main: *******************]
[2024-06-22 21:05:22,561: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:05:22,566: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:05:22,569: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:05:22,570: INFO: common: created directory at: artifacts]
[2024-06-22 21:05:22,573: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:05:24,152: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:07:13,386: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:07:13,387: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:07:13,388: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:07:37,221: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:07:37,221: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:07:37,223: INFO: main: *******************]
[2024-06-22 21:07:37,224: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:07:37,230: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:07:37,235: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:07:37,236: INFO: common: created directory at: artifacts]
[2024-06-22 21:07:37,237: ERROR: main: name 'params' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 17, in main
    val_config = config.get_validation_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 84, in get_validation_config
    all_params=params,
NameError: name 'params' is not defined
[2024-06-22 21:08:52,505: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:08:52,509: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:08:52,512: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:08:52,513: INFO: common: created directory at: artifacts]
[2024-06-22 21:08:52,514: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:08:52,516: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:08:52,518: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:08:52,518: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:08:52,520: INFO: main: *******************]
[2024-06-22 21:08:52,521: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:08:52,525: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:08:52,527: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:08:52,528: INFO: common: created directory at: artifacts]
[2024-06-22 21:08:52,530: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:08:52,532: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:08:52,533: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:08:52,534: INFO: main: *******************]
[2024-06-22 21:08:52,535: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:08:52,539: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:08:52,541: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:08:52,542: INFO: common: created directory at: artifacts]
[2024-06-22 21:08:52,543: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:08:53,854: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:10:39,591: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:10:39,592: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:10:39,594: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:11:03,371: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:11:03,372: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:11:03,374: INFO: main: *******************]
[2024-06-22 21:11:03,379: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:11:03,387: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:11:03,390: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:11:03,392: INFO: common: created directory at: artifacts]
[2024-06-22 21:11:10,933: INFO: common: Figure saved as: confusion_matrix_20240622_211109.png]
[2024-06-22 21:11:15,035: ERROR: main: name 'precision_recall_curve' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 21, in main
    evalu.precision_recall_trade_off(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 35, in precision_recall_trade_off
    precision ,recall ,threshold = precision_recall_curve(y_test,y_proba[:,1])
NameError: name 'precision_recall_curve' is not defined
[2024-06-22 21:12:39,176: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:12:39,180: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:12:39,183: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:12:39,184: INFO: common: created directory at: artifacts]
[2024-06-22 21:12:39,187: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:12:39,189: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:12:39,191: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:12:39,191: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:12:39,192: INFO: main: *******************]
[2024-06-22 21:12:39,195: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:12:39,197: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:12:39,200: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:12:39,201: INFO: common: created directory at: artifacts]
[2024-06-22 21:12:39,202: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:12:39,203: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:12:39,204: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:12:39,205: INFO: main: *******************]
[2024-06-22 21:12:39,206: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:12:39,209: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:12:39,212: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:12:39,214: INFO: common: created directory at: artifacts]
[2024-06-22 21:12:39,215: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:12:40,504: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:14:30,633: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:14:30,635: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:14:30,638: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:14:54,670: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:14:54,671: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:14:54,672: INFO: main: *******************]
[2024-06-22 21:14:54,674: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:14:54,679: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:14:54,681: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:14:54,684: INFO: common: created directory at: artifacts]
[2024-06-22 21:15:01,838: INFO: common: Figure saved as: confusion_matrix_20240622_211500.png]
[2024-06-22 21:15:18,283: INFO: common: Figure saved as: precision_recall_curve_20240622_211507.png]
[2024-06-22 21:15:18,290: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:15:18,317: ERROR: main: name 'save_json' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 21, in main
    evalu.precision_recall_trade_off(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 49, in precision_recall_trade_off
    save_json(path=Path("prt.json"), data=prt)
NameError: name 'save_json' is not defined
[2024-06-22 21:15:54,581: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:15:54,585: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:15:54,590: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:15:54,590: INFO: common: created directory at: artifacts]
[2024-06-22 21:15:54,592: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:15:54,593: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:15:54,595: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:15:54,595: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:15:54,597: INFO: main: *******************]
[2024-06-22 21:15:54,597: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:15:54,602: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:15:54,605: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:15:54,605: INFO: common: created directory at: artifacts]
[2024-06-22 21:15:54,607: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:15:54,608: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:15:54,609: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:15:54,610: INFO: main: *******************]
[2024-06-22 21:15:54,611: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:15:54,616: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:15:54,619: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:15:54,620: INFO: common: created directory at: artifacts]
[2024-06-22 21:15:54,621: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:15:55,976: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:17:40,518: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:17:40,520: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:17:40,520: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:18:05,168: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:18:05,170: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:18:05,183: INFO: main: *******************]
[2024-06-22 21:18:05,190: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:18:05,199: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:18:05,204: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:18:05,205: INFO: common: created directory at: artifacts]
[2024-06-22 21:18:11,749: INFO: common: Figure saved as: confusion_matrix_20240622_211810.png]
[2024-06-22 21:18:26,482: INFO: common: Figure saved as: precision_recall_curve_20240622_211815.png]
[2024-06-22 21:18:26,490: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:18:26,505: ERROR: main: Argument data of type <class 'pandas.core.frame.DataFrame'> to <function save_json at 0x2b29129555a0> does not match annotation type <class 'dict'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 21, in main
    evalu.precision_recall_trade_off(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 49, in precision_recall_trade_off
    save_json(path=Path("prt.json"), data=prt)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/ensure/main.py", line 803, in __call__
    raise EnsureError(msg.format(
ensure.main.EnsureError: Argument data of type <class 'pandas.core.frame.DataFrame'> to <function save_json at 0x2b29129555a0> does not match annotation type <class 'dict'>
[2024-06-22 21:20:42,021: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:20:42,025: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:20:42,027: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:20:42,029: INFO: common: created directory at: artifacts]
[2024-06-22 21:20:42,033: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:20:42,037: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:20:42,039: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:20:42,040: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:20:42,040: INFO: main: *******************]
[2024-06-22 21:20:42,040: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:20:42,043: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:20:42,048: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:20:42,049: INFO: common: created directory at: artifacts]
[2024-06-22 21:20:42,049: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:20:42,050: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:20:42,050: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:20:42,050: INFO: main: *******************]
[2024-06-22 21:20:42,050: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:20:42,053: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:20:42,057: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:20:42,059: INFO: common: created directory at: artifacts]
[2024-06-22 21:20:42,060: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:20:43,896: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:23:01,115: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:23:01,116: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:23:01,117: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:23:25,080: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:23:25,081: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:23:25,081: INFO: main: *******************]
[2024-06-22 21:23:25,081: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:23:25,084: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:23:25,087: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:23:25,089: INFO: common: created directory at: artifacts]
[2024-06-22 21:23:31,817: INFO: common: Figure saved as: confusion_matrix_20240622_212330.png]
[2024-06-22 21:23:46,587: INFO: common: Figure saved as: precision_recall_curve_20240622_212335.png]
[2024-06-22 21:23:46,595: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:23:46,616: ERROR: main: Argument data of type <class 'list'> to <function save_json at 0x2b7d4e74d5a0> does not match annotation type <class 'dict'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 21, in main
    evalu.precision_recall_trade_off(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 51, in precision_recall_trade_off
    save_json(path=Path("prt.json"), data=prt_dict)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/ensure/main.py", line 803, in __call__
    raise EnsureError(msg.format(
ensure.main.EnsureError: Argument data of type <class 'list'> to <function save_json at 0x2b7d4e74d5a0> does not match annotation type <class 'dict'>
[2024-06-22 21:26:14,937: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:26:14,943: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:26:14,949: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:26:14,952: INFO: common: created directory at: artifacts]
[2024-06-22 21:26:14,953: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:26:14,956: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:26:14,961: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:26:14,964: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:26:14,964: INFO: main: *******************]
[2024-06-22 21:26:14,965: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:26:14,968: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:26:14,971: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:26:14,973: INFO: common: created directory at: artifacts]
[2024-06-22 21:26:14,975: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:26:14,976: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:26:14,976: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:26:14,976: INFO: main: *******************]
[2024-06-22 21:26:14,976: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:26:14,981: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:26:14,983: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:26:14,984: INFO: common: created directory at: artifacts]
[2024-06-22 21:26:14,986: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:26:16,403: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:28:01,672: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:28:01,675: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:28:01,675: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:28:27,546: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:28:27,547: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:28:27,548: INFO: main: *******************]
[2024-06-22 21:28:27,548: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:28:27,553: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:28:27,556: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:28:27,560: INFO: common: created directory at: artifacts]
[2024-06-22 21:28:36,511: INFO: common: Figure saved as: confusion_matrix_20240622_212835.png]
[2024-06-22 21:28:51,433: INFO: common: Figure saved as: precision_recall_curve_20240622_212840.png]
[2024-06-22 21:28:51,443: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:28:51,493: INFO: common: json file saved at: prt.json]
[2024-06-22 21:29:06,042: INFO: common: Figure saved as: precision_recall_curve_20240622_212855.png]
[2024-06-22 21:29:06,049: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:29:06,087: INFO: common: json file saved at: prt.json]
[2024-06-22 21:29:06,092: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-22 21:42:26,186: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:42:26,189: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:42:26,191: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:42:26,193: INFO: common: created directory at: artifacts]
[2024-06-22 21:42:26,194: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:42:26,195: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:42:26,196: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:42:26,196: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:42:26,197: INFO: main: *******************]
[2024-06-22 21:42:26,197: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:42:26,200: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:42:26,202: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:42:26,203: INFO: common: created directory at: artifacts]
[2024-06-22 21:42:26,204: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:42:26,204: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:42:26,204: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:42:26,205: INFO: main: *******************]
[2024-06-22 21:42:26,205: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:42:26,208: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:42:26,210: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:42:26,211: INFO: common: created directory at: artifacts]
[2024-06-22 21:42:26,212: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:42:27,537: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:44:12,495: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:44:12,496: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:44:12,497: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:44:36,439: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:44:36,440: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:44:36,441: INFO: main: *******************]
[2024-06-22 21:44:36,441: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:44:36,444: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:44:36,448: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:44:36,451: INFO: common: created directory at: artifacts]
[2024-06-22 21:44:40,645: INFO: evaluation: 
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    182519
         1.0       0.99      0.99      0.99     17481

    accuracy                           1.00    200000
   macro avg       0.99      0.99      0.99    200000
weighted avg       1.00      1.00      1.00    200000
]
[2024-06-22 21:44:43,040: INFO: common: Figure saved as: confusion_matrix_20240622_214441.png]
[2024-06-22 21:44:43,837: ERROR: main: API request to endpoint /api/2.0/mlflow/runs/create failed with error code 403 != 200. Response body: '']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 88, in model_evaluation
    with mlflow.start_run():
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/fluent.py", line 382, in start_run
    active_run_obj = client.create_run(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/client.py", line 393, in create_run
    return self._tracking_client.create_run(experiment_id, start_time, tags, run_name)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/_tracking_service/client.py", line 165, in create_run
    return self.store.create_run(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/store/tracking/rest_store.py", line 208, in create_run
    response_proto = self._call_endpoint(CreateRun, req_body)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/rest_utils.py", line 304, in call_endpoint
    response = verify_rest_response(response, endpoint)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/rest_utils.py", line 180, in verify_rest_response
    raise MlflowException(
mlflow.exceptions.MlflowException: API request to endpoint /api/2.0/mlflow/runs/create failed with error code 403 != 200. Response body: ''
[2024-06-22 21:51:06,494: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:51:06,498: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:51:06,500: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:51:06,501: INFO: common: created directory at: artifacts]
[2024-06-22 21:51:06,502: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:51:06,503: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:51:06,504: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:51:06,504: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:51:06,504: INFO: main: *******************]
[2024-06-22 21:51:06,504: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:51:06,507: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:51:06,509: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:51:06,510: INFO: common: created directory at: artifacts]
[2024-06-22 21:51:06,510: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:51:06,511: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:51:06,511: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:51:06,511: INFO: main: *******************]
[2024-06-22 21:51:06,511: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:51:06,515: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:51:06,516: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:51:06,517: INFO: common: created directory at: artifacts]
[2024-06-22 21:51:06,517: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:51:07,996: INFO: training: Model training and cross validation initiated.]
[2024-06-22 21:52:52,986: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 21:52:52,989: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 21:52:52,989: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 21:53:17,188: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 21:53:17,190: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 21:53:17,190: INFO: main: *******************]
[2024-06-22 21:53:17,190: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 21:53:17,194: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:53:17,198: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:53:17,202: INFO: common: created directory at: artifacts]
[2024-06-22 21:53:21,436: INFO: evaluation: 
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    182519
         1.0       0.99      0.99      0.99     17481

    accuracy                           1.00    200000
   macro avg       0.99      0.99      0.99    200000
weighted avg       1.00      1.00      1.00    200000
]
[2024-06-22 21:53:26,409: INFO: common: Figure saved as: confusion_matrix_20240622_215325.png]
[2024-06-22 21:53:42,457: INFO: common: Figure saved as: precision_recall_curve_20240622_215332.png]
[2024-06-22 21:53:42,464: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:53:42,519: INFO: common: json file saved at: prt.json]
[2024-06-22 21:53:57,145: INFO: common: Figure saved as: precision_recall_curve_20240622_215346.png]
[2024-06-22 21:53:57,154: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 21:53:57,187: INFO: common: json file saved at: prt.json]
[2024-06-22 21:53:57,192: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-22 21:59:31,907: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 21:59:31,911: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:59:31,916: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:59:31,918: INFO: common: created directory at: artifacts]
[2024-06-22 21:59:31,920: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 21:59:31,921: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 21:59:31,923: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 21:59:31,923: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 21:59:31,923: INFO: main: *******************]
[2024-06-22 21:59:31,923: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 21:59:31,928: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:59:31,931: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:59:31,934: INFO: common: created directory at: artifacts]
[2024-06-22 21:59:31,936: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 21:59:31,936: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 21:59:31,936: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 21:59:31,937: INFO: main: *******************]
[2024-06-22 21:59:31,937: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 21:59:31,940: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 21:59:31,945: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 21:59:31,947: INFO: common: created directory at: artifacts]
[2024-06-22 21:59:31,948: INFO: common: created directory at: artifacts/training]
[2024-06-22 21:59:33,306: INFO: training: Model training and cross validation initiated.]
[2024-06-22 22:01:18,491: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 22:01:18,492: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 22:01:18,493: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 22:01:42,194: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 22:01:42,194: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 22:01:42,195: INFO: main: *******************]
[2024-06-22 22:01:42,195: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 22:01:42,198: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:01:42,201: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:01:42,202: INFO: common: created directory at: artifacts]
[2024-06-22 22:01:46,927: ERROR: main: name 'dagshub' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 78, in model_evaluation
    dagshub.init(repo_owner='ronair212', repo_name='mlops-model-dev', mlflow=True)
NameError: name 'dagshub' is not defined
[2024-06-22 22:02:33,765: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 22:02:33,770: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:02:33,774: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:02:33,776: INFO: common: created directory at: artifacts]
[2024-06-22 22:02:33,777: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 22:02:33,778: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 22:02:33,779: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 22:02:33,780: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 22:02:33,783: INFO: main: *******************]
[2024-06-22 22:02:33,783: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 22:02:33,787: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:02:33,790: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:02:33,791: INFO: common: created directory at: artifacts]
[2024-06-22 22:02:33,792: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 22:02:33,793: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 22:02:33,793: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 22:02:33,793: INFO: main: *******************]
[2024-06-22 22:02:33,794: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 22:02:33,798: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:02:33,801: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:02:33,802: INFO: common: created directory at: artifacts]
[2024-06-22 22:02:33,803: INFO: common: created directory at: artifacts/training]
[2024-06-22 22:02:35,225: INFO: training: Model training and cross validation initiated.]
[2024-06-22 22:04:20,617: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 22:04:20,618: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 22:04:20,619: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 22:04:44,579: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 22:04:44,579: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 22:04:44,580: INFO: main: *******************]
[2024-06-22 22:04:44,580: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 22:04:44,583: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:04:44,585: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:04:44,586: INFO: common: created directory at: artifacts]
[2024-06-22 22:04:49,494: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-22 22:04:49,496: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-22 22:04:53,921: INFO: common: Figure saved as: evaluation_metrics_20240622_220452.png]
[2024-06-22 22:05:08,269: INFO: common: Figure saved as: precision_recall_curve_20240622_220457.png]
[2024-06-22 22:05:08,276: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 22:05:08,301: INFO: common: json file saved at: prt.json]
[2024-06-22 22:05:22,634: INFO: common: Figure saved as: precision_recall_curve_20240622_220512.png]
[2024-06-22 22:05:22,640: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 22:05:22,689: INFO: common: json file saved at: prt.json]
[2024-06-22 22:05:22,695: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-22 22:12:05,686: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 22:12:05,690: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:12:05,692: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:12:05,694: INFO: common: created directory at: artifacts]
[2024-06-22 22:12:05,695: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 22:12:05,696: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 22:12:05,697: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 22:12:05,697: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 22:12:05,697: INFO: main: *******************]
[2024-06-22 22:12:05,697: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 22:12:05,701: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:12:05,703: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:12:05,704: INFO: common: created directory at: artifacts]
[2024-06-22 22:12:05,705: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 22:12:05,705: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 22:12:05,705: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 22:12:05,711: INFO: main: *******************]
[2024-06-22 22:12:05,711: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 22:12:05,715: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:12:05,717: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:12:05,718: INFO: common: created directory at: artifacts]
[2024-06-22 22:12:05,719: INFO: common: created directory at: artifacts/training]
[2024-06-22 22:12:07,238: INFO: training: Model training and cross validation initiated.]
[2024-06-22 22:13:52,342: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 22:13:52,343: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 22:13:52,343: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 22:14:15,979: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 22:14:15,980: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 22:14:15,980: INFO: main: *******************]
[2024-06-22 22:14:15,980: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 22:14:15,983: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:14:15,986: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:14:15,987: INFO: common: created directory at: artifacts]
[2024-06-22 22:14:15,988: ERROR: main: Evaluation.model_evaluation() missing 1 required positional argument: 'experiment_name']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb)
TypeError: Evaluation.model_evaluation() missing 1 required positional argument: 'experiment_name'
[2024-06-22 22:18:15,919: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 22:18:15,923: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:18:15,926: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:18:15,927: INFO: common: created directory at: artifacts]
[2024-06-22 22:18:15,927: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 22:18:15,928: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 22:18:15,929: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 22:18:15,929: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 22:18:15,930: INFO: main: *******************]
[2024-06-22 22:18:15,930: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 22:18:15,933: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:18:15,935: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:18:15,936: INFO: common: created directory at: artifacts]
[2024-06-22 22:18:15,936: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 22:18:15,937: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 22:18:15,937: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 22:18:15,937: INFO: main: *******************]
[2024-06-22 22:18:15,937: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 22:18:15,942: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:18:15,943: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:18:15,944: INFO: common: created directory at: artifacts]
[2024-06-22 22:18:15,945: INFO: common: created directory at: artifacts/training]
[2024-06-22 22:18:17,270: INFO: training: Model training and cross validation initiated.]
[2024-06-22 22:20:02,409: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 22:20:02,410: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 22:20:02,410: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 22:20:26,351: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 22:20:26,351: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 22:20:26,352: INFO: main: *******************]
[2024-06-22 22:20:26,352: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 22:20:26,355: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:20:26,357: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:20:26,358: INFO: common: created directory at: artifacts]
[2024-06-22 22:20:32,977: INFO: common: Figure saved as: evaluation_metrics_20240622_222032.png]
[2024-06-22 22:20:33,742: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-22 22:20:33,743: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-22 22:21:37,528: ERROR: main: API request to https://dagshub.com/ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create failed with exception HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))]
urllib3.exceptions.ResponseError: too many 500 error responses

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 945, in urlopen
    return self.urlopen(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 945, in urlopen
    return self.urlopen(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 945, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/urllib3/connectionpool.py", line 935, in urlopen
    retries = retries.increment(method, url, response=response, _pool=self)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/rest_utils.py", line 129, in http_request
    return _get_http_response_with_retries(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/requests/adapters.py", line 510, in send
    raise RetryError(e, request=request)
requests.exceptions.RetryError: HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 19, in main
    evalu.model_evaluation(xgb , "one")
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 120, in model_evaluation
    with mlflow.start_run(experiment_id=experiment_id):
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/fluent.py", line 382, in start_run
    active_run_obj = client.create_run(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/client.py", line 393, in create_run
    return self._tracking_client.create_run(experiment_id, start_time, tags, run_name)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/tracking/_tracking_service/client.py", line 165, in create_run
    return self.store.create_run(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/store/tracking/rest_store.py", line 208, in create_run
    response_proto = self._call_endpoint(CreateRun, req_body)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/rest_utils.py", line 302, in call_endpoint
    response = http_request(**call_kwargs)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/mlflow/utils/rest_utils.py", line 152, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to https://dagshub.com/ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create failed with exception HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /ronair212/mlops-model-dev.mlflow/api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))
[2024-06-22 22:25:49,126: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-22 22:25:49,132: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:25:49,135: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:25:49,137: INFO: common: created directory at: artifacts]
[2024-06-22 22:25:49,139: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-22 22:25:49,143: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-22 22:25:49,149: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-22 22:25:49,160: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-22 22:25:49,161: INFO: main: *******************]
[2024-06-22 22:25:49,161: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-22 22:25:49,164: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:25:49,168: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:25:49,170: INFO: common: created directory at: artifacts]
[2024-06-22 22:25:49,171: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-22 22:25:49,171: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-22 22:25:49,172: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-22 22:25:49,172: INFO: main: *******************]
[2024-06-22 22:25:49,172: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-22 22:25:49,177: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:25:49,179: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:25:49,180: INFO: common: created directory at: artifacts]
[2024-06-22 22:25:49,181: INFO: common: created directory at: artifacts/training]
[2024-06-22 22:25:50,587: INFO: training: Model training and cross validation initiated.]
[2024-06-22 22:27:36,108: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-22 22:27:36,111: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-22 22:27:36,111: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-22 22:27:59,960: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-22 22:27:59,962: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-22 22:27:59,962: INFO: main: *******************]
[2024-06-22 22:27:59,962: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-22 22:27:59,970: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-22 22:27:59,974: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-22 22:27:59,975: INFO: common: created directory at: artifacts]
[2024-06-22 22:28:08,607: INFO: common: Figure saved as: evaluation_metrics_20240622_222807.png]
[2024-06-22 22:28:10,202: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-22 22:28:10,203: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-22 22:28:25,429: INFO: common: Figure saved as: precision_recall_curve_20240622_222815.png]
[2024-06-22 22:28:25,438: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 22:28:25,469: INFO: common: json file saved at: prt.json]
[2024-06-22 22:28:39,935: INFO: common: Figure saved as: precision_recall_curve_20240622_222829.png]
[2024-06-22 22:28:39,943: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-22 22:28:39,986: INFO: common: json file saved at: prt.json]
[2024-06-22 22:28:39,991: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 17:58:44,257: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 17:58:44,272: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 17:58:44,280: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 17:58:44,282: INFO: common: created directory at: artifacts]
[2024-06-24 17:58:44,286: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 17:58:44,290: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 17:58:44,293: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 17:58:44,293: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 17:58:44,294: INFO: main: *******************]
[2024-06-24 17:58:44,294: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 17:58:44,301: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 17:58:44,305: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 17:58:44,307: INFO: common: created directory at: artifacts]
[2024-06-24 17:58:44,308: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 17:58:44,308: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 17:58:44,309: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 17:58:44,311: INFO: main: *******************]
[2024-06-24 17:58:44,312: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 17:58:44,316: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 17:58:44,320: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 17:58:44,321: INFO: common: created directory at: artifacts]
[2024-06-24 17:58:44,323: INFO: common: created directory at: artifacts/training]
[2024-06-24 17:58:45,652: INFO: training: Model training and cross validation initiated.]
[2024-06-24 18:00:21,216: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 18:00:21,219: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 18:00:21,220: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 18:00:42,603: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 18:00:42,604: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 18:00:42,605: INFO: main: *******************]
[2024-06-24 18:00:42,605: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 18:00:42,611: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 18:00:42,613: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 18:00:42,614: INFO: common: created directory at: artifacts]
[2024-06-24 18:00:55,592: INFO: common: Figure saved as: evaluation_metrics_20240624_180053.png]
[2024-06-24 18:00:56,911: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 18:00:56,912: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 18:01:11,479: INFO: common: Figure saved as: precision_recall_curve_20240624_180101.png]
[2024-06-24 18:01:11,488: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 18:01:11,546: INFO: common: json file saved at: prt.json]
[2024-06-24 18:01:25,224: INFO: common: Figure saved as: precision_recall_curve_20240624_180115.png]
[2024-06-24 18:01:25,230: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 18:01:25,253: INFO: common: json file saved at: prt.json]
[2024-06-24 18:01:25,254: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 18:09:41,244: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 18:09:41,254: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 18:09:41,258: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 18:09:41,259: INFO: common: created directory at: artifacts]
[2024-06-24 18:09:41,260: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 18:09:41,262: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 18:09:41,267: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 18:09:41,268: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 18:09:41,269: INFO: main: *******************]
[2024-06-24 18:09:41,270: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 18:09:41,278: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 18:09:41,281: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 18:09:41,283: INFO: common: created directory at: artifacts]
[2024-06-24 18:09:41,285: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 18:09:41,309: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 18:09:41,309: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 18:09:41,311: INFO: main: *******************]
[2024-06-24 18:09:41,316: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 18:09:41,335: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 18:09:41,338: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 18:09:41,338: INFO: common: created directory at: artifacts]
[2024-06-24 18:09:41,340: INFO: common: created directory at: artifacts/training]
[2024-06-24 18:09:42,696: INFO: training: Model training and cross validation initiated.]
[2024-06-24 18:11:30,536: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 18:11:30,537: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 18:11:30,538: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 18:11:53,888: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 18:11:53,889: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 18:11:53,894: INFO: main: *******************]
[2024-06-24 18:11:53,895: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 18:11:53,901: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 18:11:53,904: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 18:11:53,905: INFO: common: created directory at: artifacts]
[2024-06-24 18:12:03,763: INFO: common: Figure saved as: evaluation_metrics_20240624_181202.png]
[2024-06-24 18:12:04,893: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 18:12:04,893: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 18:12:18,941: INFO: common: Figure saved as: precision_recall_curve_20240624_181209.png]
[2024-06-24 18:12:18,950: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 18:12:18,984: INFO: common: json file saved at: prt.json]
[2024-06-24 18:12:31,854: INFO: common: Figure saved as: precision_recall_curve_20240624_181223.png]
[2024-06-24 18:12:31,861: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 18:12:31,885: INFO: common: json file saved at: prt.json]
[2024-06-24 18:12:31,886: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 19:09:22,599: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 19:09:22,603: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:09:22,618: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:09:22,619: INFO: common: created directory at: artifacts]
[2024-06-24 19:09:22,622: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 19:09:22,624: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 19:09:22,626: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 19:09:22,629: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 19:09:22,630: INFO: main: *******************]
[2024-06-24 19:09:22,632: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 19:09:22,638: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:09:22,640: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:09:22,642: INFO: common: created directory at: artifacts]
[2024-06-24 19:09:22,643: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 19:09:22,644: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 19:09:22,664: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 19:09:22,666: INFO: main: *******************]
[2024-06-24 19:09:22,667: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 19:09:22,673: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:09:22,675: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:09:22,675: INFO: common: created directory at: artifacts]
[2024-06-24 19:09:22,678: INFO: common: created directory at: artifacts/training]
[2024-06-24 19:09:23,879: INFO: training: Model training and cross validation initiated.]
[2024-06-24 19:11:07,511: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 19:11:07,512: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 19:11:07,513: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 19:11:30,942: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 19:11:30,943: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 19:11:30,945: INFO: main: *******************]
[2024-06-24 19:11:30,946: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 19:11:30,951: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:11:30,954: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:11:30,955: INFO: common: created directory at: artifacts]
[2024-06-24 19:11:37,654: INFO: common: Figure saved as: evaluation_metrics_20240624_191136.png]
[2024-06-24 19:11:38,363: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 19:11:38,364: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 19:11:51,166: INFO: common: Figure saved as: precision_recall_curve_20240624_191142.png]
[2024-06-24 19:11:51,174: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 19:11:51,197: INFO: common: json file saved at: prt.json]
[2024-06-24 19:11:56,638: INFO: common: Figure saved as: roc-auc-curve_20240624_191155.png]
[2024-06-24 19:11:56,791: ERROR: main: Argument data of type <class 'numpy.float64'> to <function save_json at 0x2adaa4365480> does not match annotation type <class 'dict'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 23, in main
    evalu.roc_auc(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/evaluation.py", line 154, in roc_auc
    save_json(path=Path("roc_auc_scores.json"), data=roc_auc_scores)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/ensure/main.py", line 803, in __call__
    raise EnsureError(msg.format(
ensure.main.EnsureError: Argument data of type <class 'numpy.float64'> to <function save_json at 0x2adaa4365480> does not match annotation type <class 'dict'>
[2024-06-24 19:12:37,893: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 19:12:37,897: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:12:37,900: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:12:37,901: INFO: common: created directory at: artifacts]
[2024-06-24 19:12:37,903: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 19:12:37,904: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 19:12:37,906: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 19:12:37,907: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 19:12:37,909: INFO: main: *******************]
[2024-06-24 19:12:37,909: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 19:12:37,915: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:12:37,917: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:12:37,918: INFO: common: created directory at: artifacts]
[2024-06-24 19:12:37,919: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 19:12:37,920: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 19:12:37,921: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 19:12:37,922: INFO: main: *******************]
[2024-06-24 19:12:37,924: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 19:12:37,928: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:12:37,931: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:12:37,932: INFO: common: created directory at: artifacts]
[2024-06-24 19:12:37,932: INFO: common: created directory at: artifacts/training]
[2024-06-24 19:12:39,262: INFO: training: Model training and cross validation initiated.]
[2024-06-24 19:14:23,343: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 19:14:23,344: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 19:14:23,347: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 19:14:47,028: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 19:14:47,029: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 19:14:47,032: INFO: main: *******************]
[2024-06-24 19:14:47,034: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 19:14:47,039: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:14:47,042: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:14:47,043: INFO: common: created directory at: artifacts]
[2024-06-24 19:14:54,431: INFO: common: Figure saved as: evaluation_metrics_20240624_191453.png]
[2024-06-24 19:14:55,093: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 19:14:55,094: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 19:15:08,177: INFO: common: Figure saved as: precision_recall_curve_20240624_191459.png]
[2024-06-24 19:15:08,185: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 19:15:08,209: INFO: common: json file saved at: prt.json]
[2024-06-24 19:15:13,625: INFO: common: Figure saved as: roc-auc-curve_20240624_191512.png]
[2024-06-24 19:15:13,774: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 19:15:13,776: INFO: main: *******************]
[2024-06-24 19:15:13,776: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 19:15:13,781: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:15:13,783: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:15:13,784: INFO: common: created directory at: artifacts]
[2024-06-24 19:15:13,785: ERROR: main: "'ConfigBox' object has no attribute 'experiment_name'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'experiment_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'experiment_name'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'experiment_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'experiment_name'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'experiment_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'experiment_name'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'experiment_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 18, in main
    mlflow_config = config.get_mlflow_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 93, in get_mlflow_config
    experiment_name = config.experiment_name,
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'experiment_name'"
[2024-06-24 19:17:24,392: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 19:17:24,396: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:17:24,399: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:17:24,401: INFO: common: created directory at: artifacts]
[2024-06-24 19:17:24,402: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 19:17:24,403: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 19:17:24,404: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 19:17:24,405: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 19:17:24,407: INFO: main: *******************]
[2024-06-24 19:17:24,407: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 19:17:24,412: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:17:24,414: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:17:24,415: INFO: common: created directory at: artifacts]
[2024-06-24 19:17:24,416: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 19:17:24,417: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 19:17:24,418: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 19:17:24,420: INFO: main: *******************]
[2024-06-24 19:17:24,421: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 19:17:24,426: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:17:24,428: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:17:24,429: INFO: common: created directory at: artifacts]
[2024-06-24 19:17:24,430: INFO: common: created directory at: artifacts/training]
[2024-06-24 19:17:25,671: INFO: training: Model training and cross validation initiated.]
[2024-06-24 19:19:09,883: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 19:19:09,884: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 19:19:09,886: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 19:19:33,332: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 19:19:33,334: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 19:19:33,336: INFO: main: *******************]
[2024-06-24 19:19:33,338: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 19:19:33,345: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:19:33,348: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:19:33,350: INFO: common: created directory at: artifacts]
[2024-06-24 19:19:40,375: INFO: common: Figure saved as: evaluation_metrics_20240624_191939.png]
[2024-06-24 19:19:41,099: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 19:19:41,100: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 19:19:54,270: INFO: common: Figure saved as: precision_recall_curve_20240624_191945.png]
[2024-06-24 19:19:54,278: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 19:19:54,302: INFO: common: json file saved at: prt.json]
[2024-06-24 19:19:59,760: INFO: common: Figure saved as: roc-auc-curve_20240624_191958.png]
[2024-06-24 19:19:59,905: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 19:19:59,906: INFO: main: *******************]
[2024-06-24 19:19:59,907: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 19:19:59,913: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:19:59,915: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:19:59,917: INFO: common: created directory at: artifacts]
[2024-06-24 19:20:00,571: ERROR: main: Evaluation.train_valid_generator() missing 1 required positional argument: 'self']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 22, in main
    X_train , X_test ,y_train , y_test  = Evaluation.train_valid_generator()
TypeError: Evaluation.train_valid_generator() missing 1 required positional argument: 'self'
[2024-06-24 19:20:42,405: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 19:20:42,410: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:20:42,413: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:20:42,414: INFO: common: created directory at: artifacts]
[2024-06-24 19:20:42,415: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 19:20:42,416: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 19:20:42,418: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 19:20:42,418: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 19:20:42,420: INFO: main: *******************]
[2024-06-24 19:20:42,421: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 19:20:42,426: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:20:42,428: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:20:42,429: INFO: common: created directory at: artifacts]
[2024-06-24 19:20:42,430: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 19:20:42,431: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 19:20:42,432: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 19:20:42,434: INFO: main: *******************]
[2024-06-24 19:20:42,435: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 19:20:42,441: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:20:42,443: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:20:42,444: INFO: common: created directory at: artifacts]
[2024-06-24 19:20:42,445: INFO: common: created directory at: artifacts/training]
[2024-06-24 19:20:43,846: INFO: training: Model training and cross validation initiated.]
[2024-06-24 19:22:29,219: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 19:22:29,221: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 19:22:29,221: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 19:22:52,698: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 19:22:52,699: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 19:22:52,702: INFO: main: *******************]
[2024-06-24 19:22:52,705: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 19:22:52,712: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:22:52,715: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:22:52,716: INFO: common: created directory at: artifacts]
[2024-06-24 19:23:01,501: INFO: common: Figure saved as: evaluation_metrics_20240624_192300.png]
[2024-06-24 19:23:02,673: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 19:23:02,673: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 19:23:16,232: INFO: common: Figure saved as: precision_recall_curve_20240624_192307.png]
[2024-06-24 19:23:16,240: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 19:23:16,280: INFO: common: json file saved at: prt.json]
[2024-06-24 19:23:21,667: INFO: common: Figure saved as: roc-auc-curve_20240624_192320.png]
[2024-06-24 19:23:21,811: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 19:23:21,812: INFO: main: *******************]
[2024-06-24 19:23:21,816: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 19:23:21,822: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:23:21,825: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:23:21,832: INFO: common: created directory at: artifacts]
[2024-06-24 19:23:22,897: ERROR: main: 'MLFlowTrackingPipeline' object has no attribute 'Evaluation']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 22, in main
    X_train , X_test ,y_train , y_test  = self.Evaluation.train_valid_generator()
AttributeError: 'MLFlowTrackingPipeline' object has no attribute 'Evaluation'
[2024-06-24 19:28:02,529: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 19:28:02,534: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:28:02,538: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:28:02,540: INFO: common: created directory at: artifacts]
[2024-06-24 19:28:02,542: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 19:28:02,547: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 19:28:02,557: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 19:28:02,557: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 19:28:02,568: INFO: main: *******************]
[2024-06-24 19:28:02,571: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 19:28:02,578: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:28:02,581: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:28:02,594: INFO: common: created directory at: artifacts]
[2024-06-24 19:28:02,600: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 19:28:02,601: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 19:28:02,604: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 19:28:02,606: INFO: main: *******************]
[2024-06-24 19:28:02,609: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 19:28:02,615: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:28:02,618: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:28:02,629: INFO: common: created directory at: artifacts]
[2024-06-24 19:28:02,634: INFO: common: created directory at: artifacts/training]
[2024-06-24 19:28:03,864: INFO: training: Model training and cross validation initiated.]
[2024-06-24 19:29:47,211: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 19:29:47,212: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 19:29:47,213: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 19:30:10,681: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 19:30:10,682: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 19:30:10,683: INFO: main: *******************]
[2024-06-24 19:30:10,685: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 19:30:10,691: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:30:10,694: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:30:10,695: INFO: common: created directory at: artifacts]
[2024-06-24 19:30:17,967: INFO: common: Figure saved as: evaluation_metrics_20240624_193016.png]
[2024-06-24 19:30:18,973: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 19:30:18,974: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 19:30:32,165: INFO: common: Figure saved as: precision_recall_curve_20240624_193023.png]
[2024-06-24 19:30:32,173: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 19:30:32,203: INFO: common: json file saved at: prt.json]
[2024-06-24 19:30:37,827: INFO: common: Figure saved as: roc-auc-curve_20240624_193036.png]
[2024-06-24 19:30:37,969: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 19:30:37,970: INFO: main: *******************]
[2024-06-24 19:30:37,977: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 19:30:37,988: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 19:30:37,994: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 19:30:38,001: INFO: common: created directory at: artifacts]
[2024-06-24 19:30:38,003: ERROR: main: 'ConfigurationManager' object has no attribute 'get_evaluation_config']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 64, in <module>
    model_tracking = MLFlowTrackingPipeline()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 12, in __init__
    self.evaluation = Evaluation(self.config.get_evaluation_config())
AttributeError: 'ConfigurationManager' object has no attribute 'get_evaluation_config'. Did you mean: 'get_validation_config'?
[2024-06-24 20:00:59,390: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 20:00:59,398: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:00:59,401: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:00:59,404: INFO: common: created directory at: artifacts]
[2024-06-24 20:00:59,406: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 20:00:59,407: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 20:00:59,410: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 20:00:59,414: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 20:00:59,416: INFO: main: *******************]
[2024-06-24 20:00:59,417: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 20:00:59,424: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:00:59,427: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:00:59,429: INFO: common: created directory at: artifacts]
[2024-06-24 20:00:59,431: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 20:00:59,432: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 20:00:59,435: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 20:00:59,438: INFO: main: *******************]
[2024-06-24 20:00:59,441: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 20:00:59,446: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:00:59,448: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:00:59,449: INFO: common: created directory at: artifacts]
[2024-06-24 20:00:59,455: INFO: common: created directory at: artifacts/training]
[2024-06-24 20:01:00,575: INFO: training: Model training and cross validation initiated.]
[2024-06-24 20:02:28,901: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 20:02:28,902: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 20:02:28,902: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 20:02:48,412: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 20:02:48,413: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 20:02:48,415: INFO: main: *******************]
[2024-06-24 20:02:48,417: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 20:02:48,424: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:02:48,427: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:02:48,428: INFO: common: created directory at: artifacts]
[2024-06-24 20:02:55,075: INFO: common: Figure saved as: evaluation_metrics_20240624_200254.png]
[2024-06-24 20:02:56,129: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 20:02:56,130: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 20:03:07,948: INFO: common: Figure saved as: precision_recall_curve_20240624_200300.png]
[2024-06-24 20:03:07,956: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 20:03:07,992: INFO: common: json file saved at: prt.json]
[2024-06-24 20:03:12,655: INFO: common: Figure saved as: roc-auc-curve_20240624_200311.png]
[2024-06-24 20:03:12,784: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 20:03:12,784: INFO: main: *******************]
[2024-06-24 20:03:12,786: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 20:03:12,792: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:03:12,794: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:03:12,799: INFO: common: created directory at: artifacts]
[2024-06-24 20:03:14,765: ERROR: main: name 'log_mlflow' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 20, in main
    log_mlflow(local_experiment_id, remote_experiment_id, self.config.all_params, X_train, X_test, y_train, y_test, xgb, mlflow_config.local_tracking_uri, mlflow_config.remote_tracking_uri)
NameError: name 'log_mlflow' is not defined
[2024-06-24 20:13:57,669: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 20:13:57,673: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:13:57,675: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:13:57,676: INFO: common: created directory at: artifacts]
[2024-06-24 20:13:57,680: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 20:13:57,685: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 20:13:57,692: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 20:13:57,694: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 20:13:57,700: INFO: main: *******************]
[2024-06-24 20:13:57,706: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 20:13:57,718: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:13:57,719: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:13:57,720: INFO: common: created directory at: artifacts]
[2024-06-24 20:13:57,722: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 20:13:57,723: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 20:13:57,725: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 20:13:57,728: INFO: main: *******************]
[2024-06-24 20:13:57,729: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 20:13:57,734: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:13:57,737: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:13:57,738: INFO: common: created directory at: artifacts]
[2024-06-24 20:13:57,739: INFO: common: created directory at: artifacts/training]
[2024-06-24 20:13:58,982: INFO: training: Model training and cross validation initiated.]
[2024-06-24 20:15:28,024: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 20:15:28,026: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 20:15:28,028: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 20:15:47,772: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 20:15:47,773: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 20:15:47,776: INFO: main: *******************]
[2024-06-24 20:15:47,778: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 20:15:47,784: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:15:47,787: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:15:47,788: INFO: common: created directory at: artifacts]
[2024-06-24 20:15:53,783: INFO: common: Figure saved as: evaluation_metrics_20240624_201552.png]
[2024-06-24 20:15:54,546: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 20:15:54,547: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 20:16:06,354: INFO: common: Figure saved as: precision_recall_curve_20240624_201558.png]
[2024-06-24 20:16:06,362: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 20:16:06,383: INFO: common: json file saved at: prt.json]
[2024-06-24 20:16:11,240: INFO: common: Figure saved as: roc-auc-curve_20240624_201610.png]
[2024-06-24 20:16:11,367: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 20:16:11,368: INFO: main: *******************]
[2024-06-24 20:16:11,369: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 20:16:11,373: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:16:11,375: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:16:11,376: INFO: common: created directory at: artifacts]
[2024-06-24 20:16:13,384: ERROR: main: 'ConfigurationManager' object has no attribute 'all_params']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 25, in main
    tracking.log_mlflow(local_experiment_id, remote_experiment_id, self.config.all_params, X_train, X_test, y_train, y_test, xgb, mlflow_config.local_tracking_uri, mlflow_config.remote_tracking_uri)
AttributeError: 'ConfigurationManager' object has no attribute 'all_params'
[2024-06-24 20:17:21,733: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 20:17:21,737: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:17:21,739: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:17:21,740: INFO: common: created directory at: artifacts]
[2024-06-24 20:17:21,741: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 20:17:21,742: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 20:17:21,744: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 20:17:21,745: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 20:17:21,746: INFO: main: *******************]
[2024-06-24 20:17:21,747: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 20:17:21,751: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:17:21,753: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:17:21,754: INFO: common: created directory at: artifacts]
[2024-06-24 20:17:21,755: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 20:17:21,756: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 20:17:21,757: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 20:17:21,758: INFO: main: *******************]
[2024-06-24 20:17:21,759: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 20:17:21,763: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:17:21,765: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:17:21,766: INFO: common: created directory at: artifacts]
[2024-06-24 20:17:21,767: INFO: common: created directory at: artifacts/training]
[2024-06-24 20:17:23,026: INFO: training: Model training and cross validation initiated.]
[2024-06-24 20:18:53,242: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 20:18:53,243: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 20:18:53,246: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 20:19:13,049: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 20:19:13,051: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 20:19:13,052: INFO: main: *******************]
[2024-06-24 20:19:13,053: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 20:19:13,059: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:19:13,062: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:19:13,062: INFO: common: created directory at: artifacts]
[2024-06-24 20:19:19,251: INFO: common: Figure saved as: evaluation_metrics_20240624_201918.png]
[2024-06-24 20:19:19,961: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 20:19:19,962: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 20:19:31,679: INFO: common: Figure saved as: precision_recall_curve_20240624_201924.png]
[2024-06-24 20:19:31,687: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 20:19:31,712: INFO: common: json file saved at: prt.json]
[2024-06-24 20:19:36,610: INFO: common: Figure saved as: roc-auc-curve_20240624_201935.png]
[2024-06-24 20:19:36,738: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 20:19:36,738: INFO: main: *******************]
[2024-06-24 20:19:36,740: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 20:19:36,744: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:19:36,747: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:19:36,748: INFO: common: created directory at: artifacts]
[2024-06-24 20:19:38,753: ERROR: main: Tracking.log_mlflow() takes 10 positional arguments but 11 were given]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 25, in main
    tracking.log_mlflow(local_experiment_id, remote_experiment_id, mlflow_config.all_params , X_train, X_test, y_train, y_test, xgb, mlflow_config.local_tracking_uri, mlflow_config.remote_tracking_uri)
TypeError: Tracking.log_mlflow() takes 10 positional arguments but 11 were given
[2024-06-24 20:21:59,951: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-24 20:21:59,956: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:21:59,959: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:21:59,960: INFO: common: created directory at: artifacts]
[2024-06-24 20:21:59,962: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-24 20:21:59,964: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-24 20:21:59,967: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-24 20:21:59,967: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-24 20:21:59,970: INFO: main: *******************]
[2024-06-24 20:21:59,971: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-24 20:21:59,977: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:21:59,979: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:21:59,980: INFO: common: created directory at: artifacts]
[2024-06-24 20:21:59,982: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-24 20:21:59,984: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-24 20:21:59,985: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-24 20:21:59,986: INFO: main: *******************]
[2024-06-24 20:21:59,989: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-24 20:21:59,994: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:21:59,996: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:21:59,997: INFO: common: created directory at: artifacts]
[2024-06-24 20:21:59,998: INFO: common: created directory at: artifacts/training]
[2024-06-24 20:22:01,263: INFO: training: Model training and cross validation initiated.]
[2024-06-24 20:23:30,048: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-24 20:23:30,049: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-24 20:23:30,050: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-24 20:23:49,904: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-24 20:23:49,905: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-24 20:23:49,921: INFO: main: *******************]
[2024-06-24 20:23:49,922: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-24 20:23:49,930: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:23:49,933: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:23:49,934: INFO: common: created directory at: artifacts]
[2024-06-24 20:23:57,365: INFO: common: Figure saved as: evaluation_metrics_20240624_202356.png]
[2024-06-24 20:23:58,812: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-24 20:23:58,814: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-24 20:24:10,863: INFO: common: Figure saved as: precision_recall_curve_20240624_202403.png]
[2024-06-24 20:24:10,872: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-24 20:24:10,903: INFO: common: json file saved at: prt.json]
[2024-06-24 20:24:15,725: INFO: common: Figure saved as: roc-auc-curve_20240624_202414.png]
[2024-06-24 20:24:15,867: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-24 20:24:15,879: INFO: main: *******************]
[2024-06-24 20:24:15,879: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-24 20:24:15,887: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-24 20:24:15,892: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-24 20:24:15,897: INFO: common: created directory at: artifacts]
[2024-06-24 20:25:04,587: INFO: main: >>>>>> stage MLFlow stage completed <<<<<<

x==========x]
[2024-06-25 01:31:53,529: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 01:31:53,534: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:31:53,537: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:31:53,538: INFO: common: created directory at: artifacts]
[2024-06-25 01:31:53,540: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 01:31:53,541: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 01:31:53,549: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 01:31:53,551: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 01:31:53,553: INFO: main: *******************]
[2024-06-25 01:31:53,555: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 01:31:53,560: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:31:53,563: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:31:53,565: INFO: common: created directory at: artifacts]
[2024-06-25 01:31:53,566: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 01:31:53,567: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 01:31:53,568: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 01:31:53,573: INFO: main: *******************]
[2024-06-25 01:31:53,575: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 01:31:53,582: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:31:53,584: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:31:53,586: INFO: common: created directory at: artifacts]
[2024-06-25 01:31:53,589: INFO: common: created directory at: artifacts/training]
[2024-06-25 01:31:54,770: INFO: training: Model training and cross validation initiated.]
[2024-06-25 01:33:24,971: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 01:33:24,972: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 01:33:24,975: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 01:33:44,808: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 01:33:44,809: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 01:33:44,811: INFO: main: *******************]
[2024-06-25 01:33:44,812: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 01:33:44,818: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:33:44,820: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:33:44,821: INFO: common: created directory at: artifacts]
[2024-06-25 01:33:51,113: INFO: common: Figure saved as: evaluation_metrics_20240625_013350.png]
[2024-06-25 01:33:51,926: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-25 01:33:51,927: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-25 01:34:03,518: INFO: common: Figure saved as: precision_recall_curve_20240625_013355.png]
[2024-06-25 01:34:03,526: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-25 01:34:03,553: INFO: common: json file saved at: prt.json]
[2024-06-25 01:34:08,366: INFO: common: Figure saved as: roc-auc-curve_20240625_013407.png]
[2024-06-25 01:34:08,486: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-25 01:34:08,486: INFO: main: *******************]
[2024-06-25 01:34:08,489: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-25 01:34:08,494: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:34:08,496: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:34:08,520: INFO: common: created directory at: artifacts]
[2024-06-25 01:34:38,769: INFO: main: >>>>>> stage MLFlow stage completed <<<<<<

x==========x]
[2024-06-25 01:43:41,376: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 01:43:41,386: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:43:41,389: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:43:41,391: INFO: common: created directory at: artifacts]
[2024-06-25 01:43:41,393: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 01:43:41,394: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 01:43:41,400: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 01:43:41,401: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 01:43:41,402: INFO: main: *******************]
[2024-06-25 01:43:41,403: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 01:43:41,411: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:43:41,420: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:43:41,421: INFO: common: created directory at: artifacts]
[2024-06-25 01:43:41,423: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 01:43:41,423: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 01:43:41,425: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 01:43:41,445: INFO: main: *******************]
[2024-06-25 01:43:41,446: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 01:43:41,452: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:43:41,455: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:43:41,456: INFO: common: created directory at: artifacts]
[2024-06-25 01:43:41,457: INFO: common: created directory at: artifacts/training]
[2024-06-25 01:43:42,857: INFO: training: Model training and cross validation initiated.]
[2024-06-25 01:45:17,770: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 01:45:17,771: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 01:45:17,774: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 01:45:39,518: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 01:45:39,519: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 01:45:39,521: INFO: main: *******************]
[2024-06-25 01:45:39,522: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 01:45:39,524: ERROR: main: EvaluationPipeline.main() takes 1 positional argument but 2 were given]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main(xgb)
TypeError: EvaluationPipeline.main() takes 1 positional argument but 2 were given
[2024-06-25 01:46:17,206: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 01:46:17,210: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:46:17,213: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:46:17,214: INFO: common: created directory at: artifacts]
[2024-06-25 01:46:17,216: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 01:46:17,217: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 01:46:17,220: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 01:46:17,221: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 01:46:17,222: INFO: main: *******************]
[2024-06-25 01:46:17,222: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 01:46:17,227: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:46:17,229: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:46:17,231: INFO: common: created directory at: artifacts]
[2024-06-25 01:46:17,233: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 01:46:17,234: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 01:46:17,235: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 01:46:17,236: INFO: main: *******************]
[2024-06-25 01:46:17,238: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 01:46:17,242: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:46:17,245: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:46:17,246: INFO: common: created directory at: artifacts]
[2024-06-25 01:46:17,248: INFO: common: created directory at: artifacts/training]
[2024-06-25 01:46:18,539: INFO: training: Model training and cross validation initiated.]
[2024-06-25 01:47:52,689: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 01:47:52,691: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 01:47:52,691: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 01:48:14,566: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 01:48:14,567: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 01:48:14,568: INFO: main: *******************]
[2024-06-25 01:48:14,569: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 01:48:14,574: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:48:14,576: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:48:14,577: INFO: common: created directory at: artifacts]
[2024-06-25 01:48:14,578: ERROR: main: name 'pickle' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 52, in <module>
    model_evalution.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_04_evaluation.py", line 18, in main
    xgb = pickle.load(open(val_config.model_save_filepath, 'rb'))
NameError: name 'pickle' is not defined
[2024-06-25 01:49:00,716: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 01:49:00,720: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:49:00,722: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:49:00,723: INFO: common: created directory at: artifacts]
[2024-06-25 01:49:00,724: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 01:49:00,726: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 01:49:00,727: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 01:49:00,728: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 01:49:00,730: INFO: main: *******************]
[2024-06-25 01:49:00,730: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 01:49:00,736: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:49:00,738: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:49:00,739: INFO: common: created directory at: artifacts]
[2024-06-25 01:49:00,740: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 01:49:00,742: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 01:49:00,753: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 01:49:00,753: INFO: main: *******************]
[2024-06-25 01:49:00,754: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 01:49:00,759: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:49:00,764: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:49:00,765: INFO: common: created directory at: artifacts]
[2024-06-25 01:49:00,766: INFO: common: created directory at: artifacts/training]
[2024-06-25 01:49:02,030: INFO: training: Model training and cross validation initiated.]
[2024-06-25 01:50:36,153: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 01:50:36,154: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 01:50:36,155: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 01:50:57,899: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 01:50:57,901: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 01:50:57,914: INFO: main: *******************]
[2024-06-25 01:50:57,916: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 01:50:57,928: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:50:57,932: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:50:57,933: INFO: common: created directory at: artifacts]
[2024-06-25 01:51:06,982: INFO: common: Figure saved as: evaluation_metrics_20240625_015105.png]
[2024-06-25 01:51:07,939: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-25 01:51:07,941: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-25 01:51:21,484: INFO: common: Figure saved as: precision_recall_curve_20240625_015112.png]
[2024-06-25 01:51:21,492: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-25 01:51:21,518: INFO: common: json file saved at: prt.json]
[2024-06-25 01:51:26,798: INFO: common: Figure saved as: roc-auc-curve_20240625_015125.png]
[2024-06-25 01:51:26,937: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-25 01:51:26,938: INFO: main: *******************]
[2024-06-25 01:51:26,939: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-25 01:51:26,943: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:51:26,945: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:51:26,947: INFO: common: created directory at: artifacts]
[2024-06-25 01:51:26,947: ERROR: main: "'ConfigBox' object has no attribute 'model_save_filepath'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'model_save_filepath'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'model_save_filepath'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'model_save_filepath'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'model_save_filepath'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'model_save_filepath'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'model_save_filepath'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'model_save_filepath'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 65, in <module>
    model_tracking.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_05_mlflow.py", line 17, in main
    mlflow_config = self.config.get_mlflow_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 93, in get_mlflow_config
    model_save_filepath=config.model_save_filepath,
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'model_save_filepath'"
[2024-06-25 01:55:04,776: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 01:55:04,785: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:55:04,789: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:55:04,791: INFO: common: created directory at: artifacts]
[2024-06-25 01:55:04,797: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 01:55:04,803: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 01:55:04,815: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 01:55:04,817: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 01:55:04,820: INFO: main: *******************]
[2024-06-25 01:55:04,825: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 01:55:04,835: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:55:04,839: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:55:04,840: INFO: common: created directory at: artifacts]
[2024-06-25 01:55:04,847: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 01:55:04,849: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 01:55:04,852: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 01:55:04,856: INFO: main: *******************]
[2024-06-25 01:55:04,858: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 01:55:04,866: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:55:04,870: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:55:04,873: INFO: common: created directory at: artifacts]
[2024-06-25 01:55:04,877: INFO: common: created directory at: artifacts/training]
[2024-06-25 01:55:06,375: INFO: training: Model training and cross validation initiated.]
[2024-06-25 01:56:40,702: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 01:56:40,703: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 01:56:40,704: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 01:57:02,268: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 01:57:02,271: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 01:57:02,277: INFO: main: *******************]
[2024-06-25 01:57:02,283: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 01:57:02,296: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:57:02,313: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:57:02,314: INFO: common: created directory at: artifacts]
[2024-06-25 01:57:09,794: INFO: common: Figure saved as: evaluation_metrics_20240625_015708.png]
[2024-06-25 01:57:11,075: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-25 01:57:11,077: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-25 01:57:25,231: INFO: common: Figure saved as: precision_recall_curve_20240625_015715.png]
[2024-06-25 01:57:25,241: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-25 01:57:25,337: INFO: common: json file saved at: prt.json]
[2024-06-25 01:57:30,456: INFO: common: Figure saved as: roc-auc-curve_20240625_015729.png]
[2024-06-25 01:57:30,579: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-25 01:57:30,579: INFO: main: *******************]
[2024-06-25 01:57:30,586: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-25 01:57:30,597: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 01:57:30,605: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 01:57:30,612: INFO: common: created directory at: artifacts]
[2024-06-25 01:58:53,015: INFO: main: >>>>>> stage MLFlow stage completed <<<<<<

x==========x]
[2024-06-25 02:08:42,484: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:08:42,489: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:08:42,493: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:08:42,497: ERROR: main: Argument path_to_yaml of type <class 'str'> to <function read_yaml at 0x2b1974c65630> does not match annotation type <class 'pathlib.Path'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 12, in <module>
    data_ingestion.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 13, in main
    config = ConfigurationManager()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 24, in __init__
    self.hyperopt_params = read_yaml(hyperopt_params_filepath)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/ensure/main.py", line 845, in __call__
    raise EnsureError(msg.format(
ensure.main.EnsureError: Argument path_to_yaml of type <class 'str'> to <function read_yaml at 0x2b1974c65630> does not match annotation type <class 'pathlib.Path'>
[2024-06-25 02:10:07,559: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:10:07,564: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:10:07,568: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:10:07,569: ERROR: main: Argument path_to_yaml of type <class 'str'> to <function read_yaml at 0x2ac879d49750> does not match annotation type <class 'pathlib.Path'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 12, in <module>
    data_ingestion.main()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_01_data_ingestion.py", line 13, in main
    config = ConfigurationManager()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 24, in __init__
    self.hyperopt_params = read_yaml(hyperopt_params_filepath)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/ensure/main.py", line 845, in __call__
    raise EnsureError(msg.format(
ensure.main.EnsureError: Argument path_to_yaml of type <class 'str'> to <function read_yaml at 0x2ac879d49750> does not match annotation type <class 'pathlib.Path'>
[2024-06-25 02:12:15,528: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:12:15,532: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:12:15,534: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:12:15,538: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:12:15,539: INFO: common: created directory at: artifacts]
[2024-06-25 02:12:15,542: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:12:15,543: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:12:15,545: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:12:15,546: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:12:15,548: INFO: main: *******************]
[2024-06-25 02:12:15,549: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:12:15,553: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:12:15,555: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:12:15,558: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:12:15,559: INFO: common: created directory at: artifacts]
[2024-06-25 02:12:15,560: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:12:15,561: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:12:15,562: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:12:15,564: INFO: main: *******************]
[2024-06-25 02:12:15,565: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:12:15,570: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:12:15,573: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:12:15,576: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:12:15,577: INFO: common: created directory at: artifacts]
[2024-06-25 02:12:15,578: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:12:15,579: ERROR: main: Training.train() takes 1 positional argument but 2 were given]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
TypeError: Training.train() takes 1 positional argument but 2 were given
[2024-06-25 02:13:50,486: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:13:50,491: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:13:50,496: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:13:50,511: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:13:50,513: INFO: common: created directory at: artifacts]
[2024-06-25 02:13:50,518: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:13:50,520: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:13:50,524: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:13:50,524: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:13:50,533: INFO: main: *******************]
[2024-06-25 02:13:50,534: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:13:50,539: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:13:50,543: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:13:50,549: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:13:50,551: INFO: common: created directory at: artifacts]
[2024-06-25 02:13:50,553: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:13:50,553: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:13:50,557: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:13:50,559: INFO: main: *******************]
[2024-06-25 02:13:50,560: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:13:50,567: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:13:50,569: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:13:50,574: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:13:50,575: INFO: common: created directory at: artifacts]
[2024-06-25 02:13:50,576: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:13:52,291: INFO: training: Model training initiated.]
[2024-06-25 02:13:52,292: INFO: training: Training without hyperparameter optimization.]
[2024-06-25 02:13:52,293: ERROR: main: 'TrainingConfig' object has no attribute 'n_estimators']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 47, in train
    n_estimators=self.config.n_estimators,
AttributeError: 'TrainingConfig' object has no attribute 'n_estimators'
[2024-06-25 02:17:05,838: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:17:05,842: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:17:05,844: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:17:05,848: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:17:05,849: INFO: common: created directory at: artifacts]
[2024-06-25 02:17:05,851: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:17:05,852: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:17:05,854: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:17:05,854: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:17:05,857: INFO: main: *******************]
[2024-06-25 02:17:05,858: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:17:05,862: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:17:05,864: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:17:05,867: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:17:05,869: INFO: common: created directory at: artifacts]
[2024-06-25 02:17:05,870: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:17:05,871: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:17:05,873: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:17:05,874: INFO: main: *******************]
[2024-06-25 02:17:05,875: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:17:05,880: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:17:05,882: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:17:05,885: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:17:05,886: INFO: common: created directory at: artifacts]
[2024-06-25 02:17:05,887: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:17:07,231: INFO: training: Model training initiated.]
[2024-06-25 02:17:07,232: INFO: training: Training without hyperparameter optimization.]
[2024-06-25 02:18:42,755: INFO: training: Cross Validation Scores: [0.99063215 0.98941648 0.9902746  0.98820164 0.98905971]]
[2024-06-25 02:18:42,756: INFO: training: Scores Mean:  0.9895169155985206]
[2024-06-25 02:18:42,756: INFO: training: Scores Standard Deviation: 0.0008679747406873597]
[2024-06-25 02:19:04,527: INFO: training: Model saved in path artifacts/training/model.pkl.]
[2024-06-25 02:19:04,529: INFO: main: >>>>>> stage Train and save model completed <<<<<<

x==========x]
[2024-06-25 02:19:04,530: INFO: main: *******************]
[2024-06-25 02:19:04,532: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2024-06-25 02:19:04,537: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:19:04,539: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:19:04,544: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:19:04,545: INFO: common: created directory at: artifacts]
[2024-06-25 02:19:10,772: INFO: common: Figure saved as: evaluation_metrics_20240625_021909.png]
[2024-06-25 02:19:11,670: INFO: helpers: Initialized MLflow to track repo "ronair212/mlops-model-dev"]
[2024-06-25 02:19:11,671: INFO: helpers: Repository ronair212/mlops-model-dev initialized!]
[2024-06-25 02:19:25,254: INFO: common: Figure saved as: precision_recall_curve_20240625_021916.png]
[2024-06-25 02:19:25,261: INFO: evaluation:         Threshold  Precision  Recall
179722   0.001308   0.967030     1.0
179723   0.001317   0.967083     1.0
179724   0.001319   0.967137     1.0
179725   0.001330   0.967190     1.0
179726   0.001333   0.967244     1.0
179727   0.001334   0.967297     1.0
179728   0.001337   0.967351     1.0
179729   0.001337   0.967405     1.0
179730   0.001338   0.967458     1.0
179731   0.001340   0.967512     1.0]
[2024-06-25 02:19:25,284: INFO: common: json file saved at: prt.json]
[2024-06-25 02:19:31,199: INFO: common: Figure saved as: roc-auc-curve_20240625_021930.png]
[2024-06-25 02:19:31,379: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2024-06-25 02:19:31,380: INFO: main: *******************]
[2024-06-25 02:19:31,381: INFO: main: >>>>>> stage MLFlow stage started <<<<<<]
[2024-06-25 02:19:31,385: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:19:31,388: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:19:31,391: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:19:31,392: INFO: common: created directory at: artifacts]
[2024-06-25 02:20:00,472: INFO: main: >>>>>> stage MLFlow stage completed <<<<<<

x==========x]
[2024-06-25 02:21:39,902: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:21:39,912: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:21:39,925: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:21:39,942: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:21:39,943: INFO: common: created directory at: artifacts]
[2024-06-25 02:21:39,962: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:21:39,968: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:21:39,975: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:21:39,976: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:21:39,980: INFO: main: *******************]
[2024-06-25 02:21:39,990: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:21:40,010: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:21:40,014: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:21:40,031: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:21:40,033: INFO: common: created directory at: artifacts]
[2024-06-25 02:21:40,037: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:21:40,038: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:21:40,040: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:21:40,044: INFO: main: *******************]
[2024-06-25 02:21:40,050: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:21:40,063: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:21:40,067: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:21:40,075: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:21:40,078: INFO: common: created directory at: artifacts]
[2024-06-25 02:21:40,081: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:21:41,776: INFO: training: Model training initiated.]
[2024-06-25 02:21:41,796: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:21:41,797: ERROR: main: 'int' object is not subscriptable]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 17, in hyperparameter_optimization
    space = create_hyperopt_space(config.params_space)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 10, in create_hyperopt_space
    if param_info["type"] == "int":
TypeError: 'int' object is not subscriptable
[2024-06-25 02:24:51,020: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:24:51,030: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:24:51,034: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:24:51,040: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:24:51,044: INFO: common: created directory at: artifacts]
[2024-06-25 02:24:51,051: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:24:51,058: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:24:51,062: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:24:51,062: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:24:51,066: INFO: main: *******************]
[2024-06-25 02:24:51,071: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:24:51,084: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:24:51,090: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:24:51,102: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:24:51,105: INFO: common: created directory at: artifacts]
[2024-06-25 02:24:51,114: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:24:51,117: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:24:51,123: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:24:51,128: INFO: main: *******************]
[2024-06-25 02:24:51,135: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:24:51,153: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:24:51,163: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:24:51,177: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:24:51,179: INFO: common: created directory at: artifacts]
[2024-06-25 02:24:51,184: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:24:52,831: INFO: training: Model training initiated.]
[2024-06-25 02:24:52,832: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:24:52,841: ERROR: main: name 'hyperopt' is not defined]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 22, in hyperparameter_optimization
    space = create_hyperopt_space(config.params_space)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 14, in create_hyperopt_space
    space[param] = hyperopt.pyll.scope.int(hp.quniform(param, param_info["min"], param_info["max"], param_info.get("step", 1)))
NameError: name 'hyperopt' is not defined
[2024-06-25 02:25:32,217: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:25:32,223: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:25:32,227: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:25:32,232: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:25:32,236: INFO: common: created directory at: artifacts]
[2024-06-25 02:25:32,238: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:25:32,240: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:25:32,245: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:25:32,248: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:25:32,251: INFO: main: *******************]
[2024-06-25 02:25:32,255: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:25:32,264: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:25:32,269: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:25:32,286: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:25:32,289: INFO: common: created directory at: artifacts]
[2024-06-25 02:25:32,294: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:25:32,295: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:25:32,299: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:25:32,304: INFO: main: *******************]
[2024-06-25 02:25:32,306: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:25:32,315: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:25:32,319: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:25:32,328: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:25:32,330: INFO: common: created directory at: artifacts]
[2024-06-25 02:25:32,334: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:25:33,666: INFO: training: Model training initiated.]
[2024-06-25 02:25:33,667: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:25:33,671: ERROR: main: Expected a dictionary for parameter info of 'max_evals', but got <class 'int'>]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 23, in hyperparameter_optimization
    space = create_hyperopt_space(config.params_space)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 12, in create_hyperopt_space
    raise ValueError(f"Expected a dictionary for parameter info of '{param}', but got {type(param_info)}")
ValueError: Expected a dictionary for parameter info of 'max_evals', but got <class 'int'>
[2024-06-25 02:27:11,657: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:27:11,666: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:27:11,670: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:27:11,677: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:27:11,679: INFO: common: created directory at: artifacts]
[2024-06-25 02:27:11,685: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:27:11,688: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:27:11,696: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:27:11,696: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:27:11,700: INFO: main: *******************]
[2024-06-25 02:27:11,706: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:27:11,720: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:27:11,725: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:27:11,744: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:27:11,752: INFO: common: created directory at: artifacts]
[2024-06-25 02:27:11,756: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:27:11,758: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:27:11,786: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:27:11,788: INFO: main: *******************]
[2024-06-25 02:27:11,792: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:27:11,803: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:27:11,808: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:27:11,815: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:27:11,818: INFO: common: created directory at: artifacts]
[2024-06-25 02:27:11,820: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:27:13,626: INFO: training: Model training initiated.]
[2024-06-25 02:27:13,627: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:27:13,637: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 33, in hyperparameter_optimization
    best_result = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 02:29:36,864: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:29:36,870: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:29:36,874: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:29:36,878: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:29:36,879: INFO: common: created directory at: artifacts]
[2024-06-25 02:29:36,880: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:29:36,882: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:29:36,884: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:29:36,885: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:29:36,886: INFO: main: *******************]
[2024-06-25 02:29:36,887: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:29:36,892: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:29:36,894: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:29:36,900: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:29:36,901: INFO: common: created directory at: artifacts]
[2024-06-25 02:29:36,903: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:29:36,904: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:29:36,905: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:29:36,906: INFO: main: *******************]
[2024-06-25 02:29:36,907: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:29:36,912: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:29:36,914: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:29:36,918: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:29:36,919: INFO: common: created directory at: artifacts]
[2024-06-25 02:29:36,921: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:29:38,148: INFO: training: Model training initiated.]
[2024-06-25 02:29:38,149: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:29:38,151: ERROR: main: 'HyperparameterOptimizationConfig' object is not subscriptable]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 26, in hyperparameter_optimization
    space = create_hyperopt_space(config_dict['params_space'])
TypeError: 'HyperparameterOptimizationConfig' object is not subscriptable
[2024-06-25 02:35:37,062: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:35:37,068: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:35:37,071: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:35:37,076: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:35:37,077: INFO: common: created directory at: artifacts]
[2024-06-25 02:35:37,081: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:35:37,082: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:35:37,085: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:35:37,090: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:35:37,094: INFO: main: *******************]
[2024-06-25 02:35:37,096: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:35:37,102: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:35:37,104: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:35:37,110: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:35:37,111: INFO: common: created directory at: artifacts]
[2024-06-25 02:35:37,113: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:35:37,114: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:35:37,115: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:35:37,117: INFO: main: *******************]
[2024-06-25 02:35:37,118: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:35:37,123: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:35:37,125: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:35:37,130: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:35:37,131: INFO: common: created directory at: artifacts]
[2024-06-25 02:35:37,132: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:35:38,567: INFO: training: Model training initiated.]
[2024-06-25 02:35:38,567: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:35:38,574: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 33, in hyperparameter_optimization
    best_result = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 02:36:42,245: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:36:42,250: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:36:42,253: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:36:42,257: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:36:42,259: INFO: common: created directory at: artifacts]
[2024-06-25 02:36:42,260: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:36:42,262: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:36:42,263: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:36:42,264: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:36:42,267: INFO: main: *******************]
[2024-06-25 02:36:42,267: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:36:42,272: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:36:42,274: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:36:42,278: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:36:42,279: INFO: common: created directory at: artifacts]
[2024-06-25 02:36:42,281: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:36:42,282: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:36:42,284: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:36:42,285: INFO: main: *******************]
[2024-06-25 02:36:42,286: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:36:42,292: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:36:42,294: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:36:42,302: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:36:42,303: INFO: common: created directory at: artifacts]
[2024-06-25 02:36:42,305: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:36:43,543: INFO: training: Model training initiated.]
[2024-06-25 02:36:43,544: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:36:43,549: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 37, in hyperparameter_optimization
    best_result = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 02:39:36,224: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:39:36,228: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:39:36,232: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:39:36,235: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:39:36,236: INFO: common: created directory at: artifacts]
[2024-06-25 02:39:36,237: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:39:36,239: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:39:36,241: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:39:36,241: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:39:36,243: INFO: main: *******************]
[2024-06-25 02:39:36,244: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:39:36,247: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:39:36,250: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:39:36,253: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:39:36,254: INFO: common: created directory at: artifacts]
[2024-06-25 02:39:36,255: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:39:36,257: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:39:36,260: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:39:36,261: INFO: main: *******************]
[2024-06-25 02:39:36,263: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:39:36,267: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:39:36,269: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:39:36,272: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:39:36,273: INFO: common: created directory at: artifacts]
[2024-06-25 02:39:36,274: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:39:37,435: INFO: training: Model training initiated.]
[2024-06-25 02:39:37,435: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:39:37,440: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 41, in hyperparameter_optimization
    best_result = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 02:46:44,991: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:46:44,995: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:46:44,999: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:46:45,002: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:46:45,003: INFO: common: created directory at: artifacts]
[2024-06-25 02:46:45,005: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:46:45,006: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:46:45,008: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:46:45,008: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:46:45,010: INFO: main: *******************]
[2024-06-25 02:46:45,011: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:46:45,015: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:46:45,017: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:46:45,020: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:46:45,021: INFO: common: created directory at: artifacts]
[2024-06-25 02:46:45,023: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:46:45,024: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:46:45,025: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:46:45,026: INFO: main: *******************]
[2024-06-25 02:46:45,028: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:46:45,032: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:46:45,034: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:46:45,037: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:46:45,038: INFO: common: created directory at: artifacts]
[2024-06-25 02:46:45,040: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:46:46,203: INFO: training: Model training initiated.]
[2024-06-25 02:46:46,204: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:46:46,205: ERROR: main: "'ConfigBox' object has no attribute 'params_space'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'params_space'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'params_space'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'params_space'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 28, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'params_space'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'params_space'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 536, in box.box.Box.__getattr__
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'params_space'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 538, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'params_space'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config.params_space)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 23, in hyperparameter_optimization
    space = create_hyperopt_space(config.params_space)
  File "box/config_box.py", line 30, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 552, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'params_space'"
[2024-06-25 02:57:41,078: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:57:41,090: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:57:41,108: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:57:41,120: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:57:41,122: INFO: common: created directory at: artifacts]
[2024-06-25 02:57:41,128: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:57:41,133: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:57:41,143: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:57:41,147: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:57:41,160: INFO: main: *******************]
[2024-06-25 02:57:41,162: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:57:41,179: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:57:41,183: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:57:41,192: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:57:41,197: INFO: common: created directory at: artifacts]
[2024-06-25 02:57:41,204: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:57:41,207: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:57:41,214: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:57:41,216: INFO: main: *******************]
[2024-06-25 02:57:41,231: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:57:41,241: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:57:41,245: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:57:41,255: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:57:41,258: INFO: common: created directory at: artifacts]
[2024-06-25 02:57:41,323: INFO: common: created directory at: artifacts/training]
[2024-06-25 02:57:42,976: INFO: training: Model training initiated.]
[2024-06-25 02:57:42,977: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 02:57:42,982: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 36, in hyperparameter_optimization
    best_result = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 02:59:59,893: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 02:59:59,899: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:59:59,904: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:59:59,910: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:59:59,912: INFO: common: created directory at: artifacts]
[2024-06-25 02:59:59,914: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 02:59:59,916: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 02:59:59,923: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 02:59:59,924: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 02:59:59,925: INFO: main: *******************]
[2024-06-25 02:59:59,927: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 02:59:59,932: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:59:59,934: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:59:59,939: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:59:59,940: INFO: common: created directory at: artifacts]
[2024-06-25 02:59:59,941: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 02:59:59,943: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 02:59:59,944: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 02:59:59,945: INFO: main: *******************]
[2024-06-25 02:59:59,947: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 02:59:59,953: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 02:59:59,955: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 02:59:59,959: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 02:59:59,960: INFO: common: created directory at: artifacts]
[2024-06-25 02:59:59,962: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:00:01,245: INFO: training: Model training initiated.]
[2024-06-25 03:00:01,245: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:00:01,256: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 39, in hyperparameter_optimization
    best = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=config.max_evals, trials=trials)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:01:10,360: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:01:10,379: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:01:10,387: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:01:10,392: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:01:10,393: INFO: common: created directory at: artifacts]
[2024-06-25 03:01:10,397: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:01:10,398: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:01:10,414: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:01:10,414: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:01:10,416: INFO: main: *******************]
[2024-06-25 03:01:10,417: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:01:10,422: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:01:10,425: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:01:10,430: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:01:10,431: INFO: common: created directory at: artifacts]
[2024-06-25 03:01:10,432: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:01:10,433: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:01:10,434: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:01:10,436: INFO: main: *******************]
[2024-06-25 03:01:10,437: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:01:10,443: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:01:10,445: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:01:10,450: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:01:10,451: INFO: common: created directory at: artifacts]
[2024-06-25 03:01:10,453: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:01:11,806: INFO: training: Model training initiated.]
[2024-06-25 03:01:11,807: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:01:11,809: ERROR: main: 'HyperparameterOptimizationConfig' object is not subscriptable]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 25, in hyperparameter_optimization
    space = create_hyperopt_space(config['params_space'])
TypeError: 'HyperparameterOptimizationConfig' object is not subscriptable
[2024-06-25 03:05:32,523: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:05:32,529: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:05:32,532: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:05:32,536: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:05:32,537: INFO: common: created directory at: artifacts]
[2024-06-25 03:05:32,538: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:05:32,542: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:05:32,544: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:05:32,544: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:05:32,546: INFO: main: *******************]
[2024-06-25 03:05:32,547: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:05:32,551: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:05:32,554: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:05:32,558: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:05:32,559: INFO: common: created directory at: artifacts]
[2024-06-25 03:05:32,563: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:05:32,565: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:05:32,566: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:05:32,567: INFO: main: *******************]
[2024-06-25 03:05:32,568: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:05:32,572: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:05:32,575: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:05:32,578: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:05:32,579: INFO: common: created directory at: artifacts]
[2024-06-25 03:05:32,580: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:05:34,001: INFO: training: Model training initiated.]
[2024-06-25 03:05:34,002: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:05:34,003: ERROR: main: 'HyperparameterOptimizationConfig' object is not subscriptable]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 25, in hyperparameter_optimization
    space = create_hyperopt_space(config['params_space'])
TypeError: 'HyperparameterOptimizationConfig' object is not subscriptable
[2024-06-25 03:06:42,225: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:06:42,231: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:06:42,235: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:06:42,239: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:06:42,240: INFO: common: created directory at: artifacts]
[2024-06-25 03:06:42,242: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:06:42,244: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:06:42,246: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:06:42,247: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:06:42,249: INFO: main: *******************]
[2024-06-25 03:06:42,250: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:06:42,255: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:06:42,257: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:06:42,262: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:06:42,263: INFO: common: created directory at: artifacts]
[2024-06-25 03:06:42,265: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:06:42,268: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:06:42,269: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:06:42,271: INFO: main: *******************]
[2024-06-25 03:06:42,273: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:06:42,279: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:06:42,281: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:06:42,288: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:06:42,289: INFO: common: created directory at: artifacts]
[2024-06-25 03:06:42,290: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:06:43,727: INFO: training: Model training initiated.]
[2024-06-25 03:06:43,728: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:06:43,732: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 42, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:08:21,039: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:08:21,045: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:21,048: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:21,050: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:21,051: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:21,053: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:08:21,054: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:08:21,055: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:08:21,056: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:08:21,058: INFO: main: *******************]
[2024-06-25 03:08:21,059: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:08:21,065: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:21,067: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:21,068: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:21,070: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:21,071: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:08:21,072: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:08:21,073: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:08:21,075: INFO: main: *******************]
[2024-06-25 03:08:21,076: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:08:21,080: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:21,083: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:21,084: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:21,085: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:21,088: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:08:21,088: ERROR: main: "'max_evals'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'max_evals'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 17, in main
    hpo_config = config.get_hyperparameter_optimization_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 113, in get_hyperparameter_optimization_config
    max_evals=params_space["max_evals"],
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'max_evals'"
[2024-06-25 03:08:54,327: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:08:54,331: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:54,338: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:54,348: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:54,350: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:54,352: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:08:54,355: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:08:54,358: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:08:54,359: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:08:54,360: INFO: main: *******************]
[2024-06-25 03:08:54,361: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:08:54,365: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:54,375: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:54,376: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:54,377: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:54,378: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:08:54,380: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:08:54,381: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:08:54,382: INFO: main: *******************]
[2024-06-25 03:08:54,383: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:08:54,388: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:08:54,390: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:08:54,392: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:08:54,393: INFO: common: created directory at: artifacts]
[2024-06-25 03:08:54,394: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:08:54,395: ERROR: main: "'max_evals'"]
Traceback (most recent call last):
  File "box/box.py", line 503, in box.box.Box.__getitem__
KeyError: 'max_evals'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 17, in main
    hpo_config = config.get_hyperparameter_optimization_config()
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/config_mngr/configuration_manager.py", line 113, in get_hyperparameter_optimization_config
    max_evals=params_space["max_evals"],
  File "box/box.py", line 524, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'max_evals'"
[2024-06-25 03:15:34,934: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:15:34,938: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:15:34,942: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:15:34,948: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:15:34,949: INFO: common: created directory at: artifacts]
[2024-06-25 03:15:34,950: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:15:34,955: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:15:34,957: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:15:34,958: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:15:34,960: INFO: main: *******************]
[2024-06-25 03:15:34,961: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:15:34,967: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:15:34,969: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:15:34,974: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:15:34,975: INFO: common: created directory at: artifacts]
[2024-06-25 03:15:34,976: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:15:34,977: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:15:34,979: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:15:34,980: INFO: main: *******************]
[2024-06-25 03:15:34,981: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:15:34,986: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:15:34,988: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:15:34,992: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:15:34,993: INFO: common: created directory at: artifacts]
[2024-06-25 03:15:34,996: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:15:36,418: INFO: training: Model training initiated.]
[2024-06-25 03:15:36,418: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:15:36,423: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 39, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:17:11,746: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:17:11,751: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:17:11,757: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:17:11,771: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:17:11,773: INFO: common: created directory at: artifacts]
[2024-06-25 03:17:11,778: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:17:11,780: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:17:11,784: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:17:11,785: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:17:11,792: INFO: main: *******************]
[2024-06-25 03:17:11,805: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:17:11,816: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:17:11,820: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:17:11,826: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:17:11,829: INFO: common: created directory at: artifacts]
[2024-06-25 03:17:11,833: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:17:11,840: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:17:11,842: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:17:11,846: INFO: main: *******************]
[2024-06-25 03:17:11,849: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:17:11,858: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:17:11,861: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:17:11,867: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:17:11,868: INFO: common: created directory at: artifacts]
[2024-06-25 03:17:11,869: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:17:13,267: INFO: training: Model training initiated.]
[2024-06-25 03:17:13,267: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:17:13,272: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 41, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:18:52,555: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:18:52,559: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:18:52,562: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:18:52,566: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:18:52,567: INFO: common: created directory at: artifacts]
[2024-06-25 03:18:52,568: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:18:52,570: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:18:52,572: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:18:52,573: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:18:52,575: INFO: main: *******************]
[2024-06-25 03:18:52,576: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:18:52,580: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:18:52,583: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:18:52,586: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:18:52,587: INFO: common: created directory at: artifacts]
[2024-06-25 03:18:52,590: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:18:52,592: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:18:52,593: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:18:52,595: INFO: main: *******************]
[2024-06-25 03:18:52,597: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:18:52,601: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:18:52,603: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:18:52,606: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:18:52,607: INFO: common: created directory at: artifacts]
[2024-06-25 03:18:52,610: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:18:53,775: INFO: training: Model training initiated.]
[2024-06-25 03:18:53,775: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:18:53,781: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 40, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:22:39,383: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:22:39,392: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:22:39,397: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:22:39,407: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:22:39,411: INFO: common: created directory at: artifacts]
[2024-06-25 03:22:39,420: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:22:39,430: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:22:39,437: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:22:39,440: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:22:39,442: INFO: main: *******************]
[2024-06-25 03:22:39,448: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:22:39,460: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:22:39,464: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:22:39,475: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:22:39,477: INFO: common: created directory at: artifacts]
[2024-06-25 03:22:39,484: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:22:39,486: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:22:39,490: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:22:39,492: INFO: main: *******************]
[2024-06-25 03:22:39,494: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:22:39,503: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:22:39,509: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:22:39,518: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:22:39,519: INFO: common: created directory at: artifacts]
[2024-06-25 03:22:39,526: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:22:41,036: INFO: training: Model training initiated.]
[2024-06-25 03:22:41,036: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:22:41,044: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 41, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:24:42,760: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:24:42,765: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:24:42,768: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:24:42,774: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:24:42,775: INFO: common: created directory at: artifacts]
[2024-06-25 03:24:42,776: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:24:42,778: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:24:42,781: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:24:42,781: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:24:42,783: INFO: main: *******************]
[2024-06-25 03:24:42,785: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:24:42,793: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:24:42,797: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:24:42,801: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:24:42,802: INFO: common: created directory at: artifacts]
[2024-06-25 03:24:42,804: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:24:42,805: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:24:42,807: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:24:42,808: INFO: main: *******************]
[2024-06-25 03:24:42,809: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:24:42,815: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:24:42,818: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:24:42,823: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:24:42,824: INFO: common: created directory at: artifacts]
[2024-06-25 03:24:42,826: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:24:44,032: INFO: training: Model training initiated.]
[2024-06-25 03:24:44,032: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:24:44,037: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 42, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:25:22,326: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:25:22,342: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:25:22,345: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:25:22,348: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:25:22,350: INFO: common: created directory at: artifacts]
[2024-06-25 03:25:22,351: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:25:22,352: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:25:22,355: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:25:22,357: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:25:22,360: INFO: main: *******************]
[2024-06-25 03:25:22,361: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:25:22,366: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:25:22,369: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:25:22,373: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:25:22,374: INFO: common: created directory at: artifacts]
[2024-06-25 03:25:22,376: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:25:22,376: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:25:22,378: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:25:22,384: INFO: main: *******************]
[2024-06-25 03:25:22,385: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:25:22,391: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:25:22,393: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:25:22,396: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:25:22,397: INFO: common: created directory at: artifacts]
[2024-06-25 03:25:22,399: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:25:23,650: INFO: training: Model training initiated.]
[2024-06-25 03:25:23,651: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:25:23,660: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 43, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:27:06,625: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:27:06,629: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:27:06,632: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:27:06,636: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:27:06,641: INFO: common: created directory at: artifacts]
[2024-06-25 03:27:06,651: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:27:06,652: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:27:06,654: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:27:06,655: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:27:06,657: INFO: main: *******************]
[2024-06-25 03:27:06,658: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:27:06,662: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:27:06,664: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:27:06,669: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:27:06,671: INFO: common: created directory at: artifacts]
[2024-06-25 03:27:06,673: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:27:06,674: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:27:06,676: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:27:06,677: INFO: main: *******************]
[2024-06-25 03:27:06,678: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:27:06,682: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:27:06,684: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:27:06,687: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:27:06,688: INFO: common: created directory at: artifacts]
[2024-06-25 03:27:06,689: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:27:07,943: INFO: training: Model training initiated.]
[2024-06-25 03:27:07,943: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:27:07,949: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 53, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:28:45,567: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:28:45,570: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:28:45,573: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:28:45,577: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:28:45,578: INFO: common: created directory at: artifacts]
[2024-06-25 03:28:45,579: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:28:45,581: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:28:45,582: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:28:45,582: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:28:45,584: INFO: main: *******************]
[2024-06-25 03:28:45,585: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:28:45,589: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:28:45,591: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:28:45,594: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:28:45,596: INFO: common: created directory at: artifacts]
[2024-06-25 03:28:45,597: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:28:45,598: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:28:45,599: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:28:45,600: INFO: main: *******************]
[2024-06-25 03:28:45,601: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:28:45,606: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:28:45,608: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:28:45,611: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:28:45,612: INFO: common: created directory at: artifacts]
[2024-06-25 03:28:45,613: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:28:46,786: INFO: training: Model training initiated.]
[2024-06-25 03:28:46,786: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:28:46,792: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 41, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:30:52,466: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:30:52,472: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:30:52,476: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:30:52,481: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:30:52,482: INFO: common: created directory at: artifacts]
[2024-06-25 03:30:52,484: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:30:52,487: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:30:52,489: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:30:52,490: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:30:52,493: INFO: main: *******************]
[2024-06-25 03:30:52,496: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:30:52,511: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:30:52,514: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:30:52,519: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:30:52,520: INFO: common: created directory at: artifacts]
[2024-06-25 03:30:52,522: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:30:52,524: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:30:52,527: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:30:52,529: INFO: main: *******************]
[2024-06-25 03:30:52,531: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:30:52,537: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:30:52,541: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:30:52,546: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:30:52,547: INFO: common: created directory at: artifacts]
[2024-06-25 03:30:52,550: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:30:54,246: INFO: training: Model training initiated.]
[2024-06-25 03:30:54,246: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:30:54,251: ERROR: main: Box can only compare two boxes or a box and a dictionary.]
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 51, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "box/box.py", line 316, in box.box.Box.__sub__
box.exceptions.BoxError: Box can only compare two boxes or a box and a dictionary.
[2024-06-25 03:32:51,106: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:32:51,112: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:32:51,115: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:32:51,120: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:32:51,121: INFO: common: created directory at: artifacts]
[2024-06-25 03:32:51,123: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:32:51,126: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:32:51,129: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:32:51,129: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:32:51,132: INFO: main: *******************]
[2024-06-25 03:32:51,133: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:32:51,138: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:32:51,140: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:32:51,145: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:32:51,146: INFO: common: created directory at: artifacts]
[2024-06-25 03:32:51,147: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:32:51,148: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:32:51,150: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:32:51,151: INFO: main: *******************]
[2024-06-25 03:32:51,153: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:32:51,158: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:32:51,160: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:32:51,165: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:32:51,166: INFO: common: created directory at: artifacts]
[2024-06-25 03:32:51,167: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:32:52,606: INFO: training: Model training initiated.]
[2024-06-25 03:32:52,607: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:32:52,616: INFO: tpe: build_posterior_wrapper took 0.002271 seconds]
[2024-06-25 03:32:52,616: INFO: tpe: TPE using 0 trials]
[2024-06-25 03:32:52,619: ERROR: fmin: job exception: 'n_estimators']
[2024-06-25 03:32:52,628: ERROR: main: 'n_estimators']
Traceback (most recent call last):
  File "/home/nair.ro/mlops-model-dev/main.py", line 38, in <module>
    obj.main(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/pipeline/stage_03_training_cross_val.py", line 21, in main
    training.train(xgb)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/training.py", line 42, in train
    best_model, best_params, best_metrics = hyperparameter_optimization(X_train, y_train, X_test, y_test, self.hpo_config)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 51, in hyperparameter_optimization
    best = fmin(fn=objective,
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 540, in fmin
    return trials.fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 671, in fmin
    return fmin(
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 300, in run
    self.serial_evaluate()
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/fmin.py", line 178, in serial_evaluate
    result = self.domain.evaluate(spec, ctrl)
  File "/home/nair.ro/miniforge3/lib/python3.10/site-packages/hyperopt/base.py", line 892, in evaluate
    rval = self.fn(pyll_rval)
  File "/home/nair.ro/mlops-model-dev/src/XGBClassifier/components/optimization.py", line 11, in objective
    n_estimators=int(params['n_estimators']),
KeyError: 'n_estimators'
[2024-06-25 03:34:05,994: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2024-06-25 03:34:05,999: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:34:06,002: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:34:06,007: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:34:06,009: INFO: common: created directory at: artifacts]
[2024-06-25 03:34:06,010: INFO: common: created directory at: artifacts/data_ingestion]
[2024-06-25 03:34:06,011: INFO: data_ingestion: File already exists of size: ~ 74490 KB]
[2024-06-25 03:34:06,013: INFO: data_ingestion:  File 'artifacts/data_ingestion/card_transdata.csv' is of type '.csv']
[2024-06-25 03:34:06,014: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2024-06-25 03:34:06,016: INFO: main: *******************]
[2024-06-25 03:34:06,017: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2024-06-25 03:34:06,022: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:34:06,025: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:34:06,029: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:34:06,031: INFO: common: created directory at: artifacts]
[2024-06-25 03:34:06,032: INFO: common: created directory at: artifacts/prepare_base_model]
[2024-06-25 03:34:06,033: INFO: prepare_base_model: Initialized XGBClassifier with following parameters PrepareBaseModelConfig(params_n_estimators=500, params_learning_rate=0.1, params_random_state=42, params_subsample=0.5, params_n_jobs=-1, params_max_depth=3)]
[2024-06-25 03:34:06,038: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2024-06-25 03:34:06,039: INFO: main: *******************]
[2024-06-25 03:34:06,041: INFO: main: >>>>>> stage Train and save model started <<<<<<]
[2024-06-25 03:34:06,049: INFO: common: yaml file: config/config.yaml loaded successfully]
[2024-06-25 03:34:06,052: INFO: common: yaml file: params.yaml loaded successfully]
[2024-06-25 03:34:06,057: INFO: common: yaml file: /home/nair.ro/mlops-model-dev/hyperopt_params.yaml loaded successfully]
[2024-06-25 03:34:06,058: INFO: common: created directory at: artifacts]
[2024-06-25 03:34:06,060: INFO: common: created directory at: artifacts/training]
[2024-06-25 03:34:07,294: INFO: training: Model training initiated.]
[2024-06-25 03:34:07,295: INFO: training: Hyperparameter optimization using Hyperopt initiated.]
[2024-06-25 03:34:07,307: INFO: tpe: build_posterior_wrapper took 0.002190 seconds]
[2024-06-25 03:34:07,308: INFO: tpe: TPE using 0 trials]
[2024-06-25 03:34:10,397: INFO: tpe: build_posterior_wrapper took 0.001393 seconds]
[2024-06-25 03:34:10,397: INFO: tpe: TPE using 1/1 trials with best loss -0.990046]
[2024-06-25 03:34:13,569: INFO: tpe: build_posterior_wrapper took 0.001245 seconds]
[2024-06-25 03:34:13,570: INFO: tpe: TPE using 2/2 trials with best loss -0.990046]
[2024-06-25 03:34:16,603: INFO: tpe: build_posterior_wrapper took 0.001243 seconds]
[2024-06-25 03:34:16,604: INFO: tpe: TPE using 3/3 trials with best loss -0.990733]
[2024-06-25 03:34:19,854: INFO: tpe: build_posterior_wrapper took 0.001543 seconds]
[2024-06-25 03:34:19,855: INFO: tpe: TPE using 4/4 trials with best loss -0.990733]
[2024-06-25 03:34:22,858: INFO: tpe: build_posterior_wrapper took 0.001327 seconds]
[2024-06-25 03:34:22,859: INFO: tpe: TPE using 5/5 trials with best loss -0.990733]
[2024-06-25 03:34:25,938: INFO: tpe: build_posterior_wrapper took 0.001317 seconds]
[2024-06-25 03:34:25,939: INFO: tpe: TPE using 6/6 trials with best loss -0.990733]
[2024-06-25 03:34:29,119: INFO: tpe: build_posterior_wrapper took 0.001326 seconds]
[2024-06-25 03:34:29,120: INFO: tpe: TPE using 7/7 trials with best loss -0.990733]
[2024-06-25 03:34:31,931: INFO: tpe: build_posterior_wrapper took 0.001198 seconds]
[2024-06-25 03:34:31,931: INFO: tpe: TPE using 8/8 trials with best loss -0.990733]
[2024-06-25 03:34:35,618: INFO: tpe: build_posterior_wrapper took 0.001375 seconds]
[2024-06-25 03:34:35,619: INFO: tpe: TPE using 9/9 trials with best loss -0.990733]
[2024-06-25 03:34:38,605: INFO: tpe: build_posterior_wrapper took 0.001306 seconds]
[2024-06-25 03:34:38,605: INFO: tpe: TPE using 10/10 trials with best loss -0.990733]
[2024-06-25 03:34:42,018: INFO: tpe: build_posterior_wrapper took 0.001529 seconds]
[2024-06-25 03:34:42,019: INFO: tpe: TPE using 11/11 trials with best loss -0.990733]
[2024-06-25 03:34:45,392: INFO: tpe: build_posterior_wrapper took 0.001364 seconds]
[2024-06-25 03:34:45,393: INFO: tpe: TPE using 12/12 trials with best loss -0.990733]
[2024-06-25 03:34:48,237: INFO: tpe: build_posterior_wrapper took 0.001307 seconds]
[2024-06-25 03:34:48,237: INFO: tpe: TPE using 13/13 trials with best loss -0.990733]
[2024-06-25 03:34:51,899: INFO: tpe: build_posterior_wrapper took 0.001298 seconds]
[2024-06-25 03:34:51,900: INFO: tpe: TPE using 14/14 trials with best loss -0.990962]
[2024-06-25 03:34:55,108: INFO: tpe: build_posterior_wrapper took 0.001258 seconds]
[2024-06-25 03:34:55,109: INFO: tpe: TPE using 15/15 trials with best loss -0.990962]
[2024-06-25 03:34:57,988: INFO: tpe: build_posterior_wrapper took 0.001509 seconds]
[2024-06-25 03:34:57,988: INFO: tpe: TPE using 16/16 trials with best loss -0.990962]
[2024-06-25 03:35:01,547: INFO: tpe: build_posterior_wrapper took 0.001325 seconds]
[2024-06-25 03:35:01,547: INFO: tpe: TPE using 17/17 trials with best loss -0.990962]
[2024-06-25 03:35:04,419: INFO: tpe: build_posterior_wrapper took 0.001315 seconds]
[2024-06-25 03:35:04,420: INFO: tpe: TPE using 18/18 trials with best loss -0.990962]
[2024-06-25 03:35:08,220: INFO: tpe: build_posterior_wrapper took 0.001309 seconds]
[2024-06-25 03:35:08,221: INFO: tpe: TPE using 19/19 trials with best loss -0.990962]
[2024-06-25 03:35:11,396: INFO: tpe: build_posterior_wrapper took 0.001285 seconds]
[2024-06-25 03:35:11,396: INFO: tpe: TPE using 20/20 trials with best loss -0.990962]
[2024-06-25 03:35:14,330: INFO: tpe: build_posterior_wrapper took 0.001274 seconds]
[2024-06-25 03:35:14,330: INFO: tpe: TPE using 21/21 trials with best loss -0.990962]
[2024-06-25 03:35:17,513: INFO: tpe: build_posterior_wrapper took 0.001309 seconds]
[2024-06-25 03:35:17,514: INFO: tpe: TPE using 22/22 trials with best loss -0.990962]
[2024-06-25 03:35:20,751: INFO: tpe: build_posterior_wrapper took 0.001363 seconds]
[2024-06-25 03:35:20,753: INFO: tpe: TPE using 23/23 trials with best loss -0.991648]
[2024-06-25 03:35:24,300: INFO: tpe: build_posterior_wrapper took 0.001312 seconds]
[2024-06-25 03:35:24,302: INFO: tpe: TPE using 24/24 trials with best loss -0.991648]
[2024-06-25 03:35:27,828: INFO: tpe: build_posterior_wrapper took 0.001316 seconds]
[2024-06-25 03:35:27,828: INFO: tpe: TPE using 25/25 trials with best loss -0.991648]
[2024-06-25 03:35:30,766: INFO: tpe: build_posterior_wrapper took 0.001366 seconds]
[2024-06-25 03:35:30,767: INFO: tpe: TPE using 26/26 trials with best loss -0.991648]
[2024-06-25 03:35:34,171: INFO: tpe: build_posterior_wrapper took 0.001534 seconds]
[2024-06-25 03:35:34,172: INFO: tpe: TPE using 27/27 trials with best loss -0.991648]
